<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="R2spa">
<title>Multi-Factor Measurement Model â€¢ R2spa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-Factor Measurement Model">
<meta property="og:description" content="R2spa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">R2spa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gr-std-coef.html">Grand Standardized Coefficients</a>
    <a class="dropdown-item" href="../articles/multiple-factors.html">Multi-Factor Measurement Model</a>
    <a class="dropdown-item" href="../articles/tspa-vignette.html">Two-Stage Path Analysis (2S-PA) Model Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multi-Factor Measurement Model</h1>
            
      
      
      <div class="d-none name"><code>multiple-factors.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gengrui-zhang.github.io/R2spa/">R2spa</a></span><span class="op">)</span></span></code></pre></div>
<p>The example is from <a href="https://lavaan.ugent.be/tutorial/sem.html" class="external-link uri">https://lavaan.ugent.be/tutorial/sem.html</a>.</p>
<div class="section level2">
<h2 id="factor-score">Factor score<a class="anchor" aria-label="anchor" href="#factor-score"></a>
</h2>
<p>For a CFA model with multiple latent factors, even when each
indicator only loads on one factor, the resulting factor scores
generally are weighted composites of <strong>ALL</strong> indicators.
Consider the regression score, which has the form</p>
<p><span class="math display">\[\tilde{\boldsymbol \eta} =
\mathbf{A}(\mathbf{y} - \hat{\boldsymbol \mu}) +
\boldsymbol{\alpha}\]</span></p>
<p>where <span class="math inline">\(\mathbf{A} =
\boldsymbol{\Psi}\boldsymbol{\Lambda}^\top
\hat{\boldsymbol{\Sigma}}^{-1}\)</span> is a <span class="math inline">\(q\)</span> <span class="math inline">\(\times\)</span> <span class="math inline">\(p\)</span> matrix, <span class="math inline">\(\hat{\boldsymbol \mu} = \boldsymbol{\nu} +
\boldsymbol{\Lambda} \boldsymbol{\alpha}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma} = \boldsymbol{\Lambda}
\boldsymbol{\Psi}\boldsymbol{\Lambda}^\top +
\boldsymbol{\Theta}\)</span> are the model-implied means and covariances
of the indicators <span class="math inline">\(\mathbf{y}\)</span>, and
<span class="math inline">\(\boldsymbol{\alpha}\)</span> and <span class="math inline">\(\boldsymbol{\Psi}\)</span> are the latent means
and latent covariances.</p>
<p>Therefore, assuming that the model is correctly specified such that
<span class="math inline">\(\mathbf{y} = \boldsymbol{\nu} +
\boldsymbol{\Lambda} \boldsymbol{\eta} +
\boldsymbol{\varepsilon}\)</span>,</p>
<p><span class="math display">\[
  \begin{aligned}
  \tilde{\boldsymbol \eta} &amp; = \mathbf{A}(\boldsymbol{\Lambda}
\boldsymbol{\eta} + \boldsymbol{\varepsilon} - \boldsymbol{\Lambda}
\boldsymbol{\alpha}) + \boldsymbol{\alpha} \\
  &amp; = (\mathbf{I} - \mathbf{A}\boldsymbol{\Lambda})
\boldsymbol{\alpha} +
  \mathbf{A}\boldsymbol{\Lambda} \boldsymbol{\eta} +
\mathbf{A}\boldsymbol{\varepsilon}.
  \end{aligned}
\]</span></p>
<p>If we consider <span class="math inline">\(\tilde{\boldsymbol
\eta}\)</span> as indicators of <span class="math inline">\(\boldsymbol
\eta\)</span>, we can see that <span class="math inline">\(\boldsymbol{\nu}_\tilde{\boldsymbol{\eta}} =
(\mathbf{I} - \mathbf{A}\boldsymbol{\Lambda})
\boldsymbol{\alpha}\)</span> is the intercept, <span class="math inline">\(\boldsymbol{\Lambda}_\tilde{\boldsymbol{\eta}} =
\mathbf{A}\boldsymbol{\Lambda}\)</span> is the <span class="math inline">\(q\)</span> <span class="math inline">\(\times\)</span> <span class="math inline">\(q\)</span> loading matrix, and <span class="math inline">\(\boldsymbol{\Theta}_\tilde{\boldsymbol{\eta}} =
\mathbf{A}\boldsymbol{\varepsilon}\)</span> is the error covariance
matrix.</p>
<p>We can see that <span class="math inline">\(\boldsymbol{\Lambda}_\tilde{\boldsymbol{\eta}}\)</span>
is generally not diagonal, as the following shows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CFA</span></span>
<span><span class="va">my_cfa</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  # latent variables</span></span>
<span><span class="st">    ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">    dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">"</span></span>
<span><span class="va">cfa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">my_cfa</span>,</span>
<span>               data  <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>               std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># A matrix</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span></span>
<span><span class="va">lambda_mat</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">lambda</span></span>
<span><span class="va">psi_mat</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">psi</span></span>
<span><span class="va">sigma_mat</span> <span class="op">&lt;-</span> <span class="va">cfa_fit</span><span class="op">@</span><span class="va">implied</span><span class="op">$</span><span class="va">cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ginvsigma</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">ginv</a></span><span class="op">(</span><span class="va">sigma_mat</span><span class="op">)</span></span>
<span><span class="va">alambda</span> <span class="op">&lt;-</span> <span class="va">psi_mat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">lambda_mat</span>, <span class="va">ginvsigma</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lambda_mat</span><span class="op">)</span></span>
<span><span class="va">alambda</span></span>
<span><span class="co">#&gt;            ind60      dem60</span></span>
<span><span class="co">#&gt; ind60 0.95538579 0.01834111</span></span>
<span><span class="co">#&gt; dem60 0.05816994 0.86888887</span></span></code></pre></div>
<p>We can also use <code><a href="../reference/get_fs.html">R2spa::get_fs()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fs_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span>, model <span class="op">=</span> <span class="va">my_cfa</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     fs_ind60   fs_dem60 fs_ind60_se fs_dem60_se ind60_by_fs_ind60</span></span>
<span><span class="co">#&gt; 1 -0.8101568 -1.3119114   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt; 2  0.1888466 -1.3644831   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt; 3  1.0960931  1.3107705   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt; 4  1.8702043  1.4849083   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt; 5  1.2446060  0.9193277   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt; 6  0.3348621  0.4886331   0.1859987   0.3012901         0.9553858</span></span>
<span><span class="co">#&gt;   ind60_by_fs_dem60 dem60_by_fs_ind60 dem60_by_fs_dem60 evfs_ind60_ind60</span></span>
<span><span class="co">#&gt; 1        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt; 2        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt; 3        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt; 4        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt; 5        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt; 6        0.05816994        0.01834111         0.8688889       0.03459552</span></span>
<span><span class="co">#&gt;   evfs_dem60_ind60 evfs_dem60_dem60</span></span>
<span><span class="co">#&gt; 1      0.004017388       0.09077571</span></span>
<span><span class="co">#&gt; 2      0.004017388       0.09077571</span></span>
<span><span class="co">#&gt; 3      0.004017388       0.09077571</span></span>
<span><span class="co">#&gt; 4      0.004017388       0.09077571</span></span>
<span><span class="co">#&gt; 5      0.004017388       0.09077571</span></span>
<span><span class="co">#&gt; 6      0.004017388       0.09077571</span></span></code></pre></div>
<p>Therefore, we need to specify cross-loadings when using 2S-PA.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tspa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa.html">tspa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"dem60 ~ ind60"</span>, data <span class="op">=</span> <span class="va">fs_dat</span>,</span>
<span>                 vc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat</span>, <span class="st">"av_efs"</span><span class="op">)</span>, </span>
<span>                 cross_loadings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat</span>, <span class="st">"fsA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tspa_fit</span>, <span class="st">"tspaModel"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # latent variables (indicated by factor scores)</span></span>
<span><span class="co">#&gt;  ind60 =~ 0.955385785456617 * fs_ind60 + 0.0581699407736295 * fs_dem60</span></span>
<span><span class="co">#&gt;  dem60 =~ 0.0183411131911887 * fs_ind60 + 0.868888868390616 * fs_dem60</span></span>
<span><span class="co">#&gt;  # constrain the errors</span></span>
<span><span class="co">#&gt;  fs_ind60 ~~ 0.0345955179271981 * fs_ind60</span></span>
<span><span class="co">#&gt;  fs_dem60 ~~ 0.00401738814566851 * fs_ind60</span></span>
<span><span class="co">#&gt;  fs_dem60 ~~ 0.0907757082269278 * fs_dem60</span></span>
<span><span class="co">#&gt;  # regressions</span></span>
<span><span class="co">#&gt;  dem60 ~ ind60</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterestimates</a></span><span class="op">(</span><span class="va">tspa_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lhs op      rhs   est    se     z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1     ind60 =~ fs_ind60 0.955 0.000    NA     NA    0.955    0.955</span></span>
<span><span class="co">#&gt; 2     ind60 =~ fs_dem60 0.058 0.000    NA     NA    0.058    0.058</span></span>
<span><span class="co">#&gt; 3     dem60 =~ fs_ind60 0.018 0.000    NA     NA    0.018    0.018</span></span>
<span><span class="co">#&gt; 4     dem60 =~ fs_dem60 0.869 0.000    NA     NA    0.869    0.869</span></span>
<span><span class="co">#&gt; 5  fs_ind60 ~~ fs_ind60 0.035 0.000    NA     NA    0.035    0.035</span></span>
<span><span class="co">#&gt; 6  fs_ind60 ~~ fs_dem60 0.004 0.000    NA     NA    0.004    0.004</span></span>
<span><span class="co">#&gt; 7  fs_dem60 ~~ fs_dem60 0.091 0.000    NA     NA    0.091    0.091</span></span>
<span><span class="co">#&gt; 8     dem60  ~    ind60 0.460 0.113 4.089      0    0.240    0.681</span></span>
<span><span class="co">#&gt; 9     ind60 ~~    ind60 1.000 0.169 5.900      0    0.668    1.332</span></span>
<span><span class="co">#&gt; 10    dem60 ~~    dem60 0.788 0.150 5.267      0    0.495    1.081</span></span></code></pre></div>
<p>which is more consistent with the SEM results.</p>
</div>
<div class="section level2">
<h2 id="three-factor-model-example">Three-factor model example<a class="anchor" aria-label="anchor" href="#three-factor-model-example"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CFA</span></span>
<span><span class="va">cfa_3fac</span> <span class="op">&lt;-</span>  <span class="st">"</span></span>
<span><span class="st">  # latent variables</span></span>
<span><span class="st">    ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">    dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">    dem65 =~ y5 + y6 + y7 + y8</span></span>
<span><span class="st">"</span></span>
<span><span class="va">cfa_3fac_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">cfa_3fac</span>,</span>
<span>                    data  <span class="op">=</span> <span class="va">PoliticalDemocracy</span>,</span>
<span>                    std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># A matrix</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_3fac_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span></span>
<span><span class="va">lambda_mat</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">lambda</span></span>
<span><span class="va">psi_mat</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">psi</span></span>
<span><span class="va">sigma_mat</span> <span class="op">&lt;-</span> <span class="va">cfa_3fac_fit</span><span class="op">@</span><span class="va">implied</span><span class="op">$</span><span class="va">cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ginvsigma</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">ginv</a></span><span class="op">(</span><span class="va">sigma_mat</span><span class="op">)</span></span>
<span><span class="va">alambda</span> <span class="op">&lt;-</span> <span class="va">psi_mat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">lambda_mat</span>, <span class="va">ginvsigma</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lambda_mat</span><span class="op">)</span></span>
<span><span class="va">alambda</span></span>
<span><span class="co">#&gt;             ind60        dem60      dem65</span></span>
<span><span class="co">#&gt; ind60  0.95064774 -0.005967124 0.02951139</span></span>
<span><span class="co">#&gt; dem60 -0.02069724  0.533020047 0.41603787</span></span>
<span><span class="co">#&gt; dem65  0.09868528  0.401095944 0.49133377</span></span></code></pre></div>
<p>We can also use <code><a href="../reference/get_fs.html">R2spa::get_fs()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fs_dat_3fac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span>, model <span class="op">=</span> <span class="va">cfa_3fac</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     fs_ind60   fs_dem60    fs_dem65 fs_ind60_se fs_dem60_se fs_dem65_se</span></span>
<span><span class="co">#&gt; 1 -0.7990475 -1.1571745 -1.13720655   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt; 2  0.2152486 -1.0238236 -0.80871922   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt; 3  1.1028297  1.3890842  1.46389950   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt; 4  1.8585004  1.3163888  1.43045560   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt; 5  1.2432985  0.9522026  1.03348589   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt; 6  0.3067994  0.1109206  0.05023217   0.1844193   0.2422541   0.2270976</span></span>
<span><span class="co">#&gt;   ind60_by_fs_ind60 ind60_by_fs_dem60 ind60_by_fs_dem65 dem60_by_fs_ind60</span></span>
<span><span class="co">#&gt; 1         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt; 2         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt; 3         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt; 4         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt; 5         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt; 6         0.9506477       -0.02069724        0.09868528      -0.005967124</span></span>
<span><span class="co">#&gt;   dem60_by_fs_dem60 dem60_by_fs_dem65 dem65_by_fs_ind60 dem65_by_fs_dem60</span></span>
<span><span class="co">#&gt; 1           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt; 2           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt; 3           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt; 4           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt; 5           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt; 6           0.53302         0.4010959        0.02951139         0.4160379</span></span>
<span><span class="co">#&gt;   dem65_by_fs_dem65 evfs_ind60_ind60 evfs_dem60_ind60 evfs_dem60_dem60</span></span>
<span><span class="co">#&gt; 1         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt; 2         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt; 3         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt; 4         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt; 5         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt; 6         0.4913338        0.0340105     0.0003881641       0.05868703</span></span>
<span><span class="co">#&gt;   evfs_dem65_ind60 evfs_dem65_dem60 evfs_dem65_dem65</span></span>
<span><span class="co">#&gt; 1      0.005026024       0.05337525        0.0515733</span></span>
<span><span class="co">#&gt; 2      0.005026024       0.05337525        0.0515733</span></span>
<span><span class="co">#&gt; 3      0.005026024       0.05337525        0.0515733</span></span>
<span><span class="co">#&gt; 4      0.005026024       0.05337525        0.0515733</span></span>
<span><span class="co">#&gt; 5      0.005026024       0.05337525        0.0515733</span></span>
<span><span class="co">#&gt; 6      0.005026024       0.05337525        0.0515733</span></span></code></pre></div>
<p>Therefore, we need to specify cross-loadings when using 2S-PA.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tspa_fit_3fac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa.html">tspa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"dem60 ~ ind60</span></span>
<span><span class="st">              dem65 ~ ind60 + dem60"</span>,</span>
<span>              data <span class="op">=</span> <span class="va">fs_dat_3fac</span>,</span>
<span>              vc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat_3fac</span>, <span class="st">"av_efs"</span><span class="op">)</span>,</span>
<span>              cross_loadings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat_3fac</span>, <span class="st">"fsA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tspa_fit_3fac</span>, <span class="st">"tspaModel"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # latent variables (indicated by factor scores)</span></span>
<span><span class="co">#&gt;  ind60 =~ 0.950647742844847 * fs_ind60 + -0.0206972362902851 * fs_dem60 + 0.0986852834195767 * fs_dem65</span></span>
<span><span class="co">#&gt;  dem60 =~ -0.00596712444175395 * fs_ind60 + 0.533020047181513 * fs_dem60 + 0.401095943690546 * fs_dem65</span></span>
<span><span class="co">#&gt;  dem65 =~ 0.0295113941487134 * fs_ind60 + 0.416037872255944 * fs_dem60 + 0.491333767947424 * fs_dem65</span></span>
<span><span class="co">#&gt;  # constrain the errors</span></span>
<span><span class="co">#&gt;  fs_ind60 ~~ 0.0340104951546674 * fs_ind60</span></span>
<span><span class="co">#&gt;  fs_dem60 ~~ 0.00038816407039879 * fs_ind60</span></span>
<span><span class="co">#&gt;  fs_dem65 ~~ 0.00502602420598866 * fs_ind60</span></span>
<span><span class="co">#&gt;  fs_dem60 ~~ 0.0586870313996517 * fs_dem60</span></span>
<span><span class="co">#&gt;  fs_dem65 ~~ 0.0533752457536215 * fs_dem60</span></span>
<span><span class="co">#&gt;  fs_dem65 ~~ 0.0515732993693881 * fs_dem65</span></span>
<span><span class="co">#&gt;  # regressions</span></span>
<span><span class="co">#&gt;  dem60 ~ ind60</span></span>
<span><span class="co">#&gt;               dem65 ~ ind60 + dem60</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterestimates</a></span><span class="op">(</span><span class="va">tspa_fit_3fac</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lhs op      rhs    est    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1     ind60 =~ fs_ind60  0.951 0.000     NA     NA    0.951    0.951</span></span>
<span><span class="co">#&gt; 2     ind60 =~ fs_dem60 -0.021 0.000     NA     NA   -0.021   -0.021</span></span>
<span><span class="co">#&gt; 3     ind60 =~ fs_dem65  0.099 0.000     NA     NA    0.099    0.099</span></span>
<span><span class="co">#&gt; 4     dem60 =~ fs_ind60 -0.006 0.000     NA     NA   -0.006   -0.006</span></span>
<span><span class="co">#&gt; 5     dem60 =~ fs_dem60  0.533 0.000     NA     NA    0.533    0.533</span></span>
<span><span class="co">#&gt; 6     dem60 =~ fs_dem65  0.401 0.000     NA     NA    0.401    0.401</span></span>
<span><span class="co">#&gt; 7     dem65 =~ fs_ind60  0.030 0.000     NA     NA    0.030    0.030</span></span>
<span><span class="co">#&gt; 8     dem65 =~ fs_dem60  0.416 0.000     NA     NA    0.416    0.416</span></span>
<span><span class="co">#&gt; 9     dem65 =~ fs_dem65  0.491 0.000     NA     NA    0.491    0.491</span></span>
<span><span class="co">#&gt; 10 fs_ind60 ~~ fs_ind60  0.034 0.000     NA     NA    0.034    0.034</span></span>
<span><span class="co">#&gt; 11 fs_ind60 ~~ fs_dem60  0.000 0.000     NA     NA    0.000    0.000</span></span>
<span><span class="co">#&gt; 12 fs_ind60 ~~ fs_dem65  0.005 0.000     NA     NA    0.005    0.005</span></span>
<span><span class="co">#&gt; 13 fs_dem60 ~~ fs_dem60  0.059 0.000     NA     NA    0.059    0.059</span></span>
<span><span class="co">#&gt; 14 fs_dem60 ~~ fs_dem65  0.053 0.000     NA     NA    0.053    0.053</span></span>
<span><span class="co">#&gt; 15 fs_dem65 ~~ fs_dem65  0.052 0.000     NA     NA    0.052    0.052</span></span>
<span><span class="co">#&gt; 16    dem60  ~    ind60  0.448 0.114  3.937  0.000    0.225    0.671</span></span>
<span><span class="co">#&gt; 17    dem65  ~    ind60  0.146 0.069  2.112  0.035    0.010    0.281</span></span>
<span><span class="co">#&gt; 18    dem65  ~    dem60  0.913 0.073 12.435  0.000    0.769    1.057</span></span>
<span><span class="co">#&gt; 19    ind60 ~~    ind60  1.000 0.169  5.902  0.000    0.668    1.332</span></span>
<span><span class="co">#&gt; 20    dem60 ~~    dem60  0.799 0.153  5.224  0.000    0.499    1.099</span></span>
<span><span class="co">#&gt; 21    dem65 ~~    dem65  0.026 0.043  0.620  0.535   -0.057    0.110</span></span></code></pre></div>
<p>Compare to SEM:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sem_3fac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  # latent variables</span></span>
<span><span class="st">    ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">    dem60 =~ y1 + y2 + y3 + y4</span></span>
<span><span class="st">    dem65 =~ y5 + y6 + y7 + y8</span></span>
<span><span class="st">  # structural model</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st">  "</span>,</span>
<span>  data <span class="op">=</span> <span class="va">PoliticalDemocracy</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedSolution</a></span><span class="op">(</span><span class="va">sem_3fac</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs est.std    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1  ind60 =~    x1   0.920 0.023 39.823  0.000    0.874    0.965</span></span>
<span><span class="co">#&gt; 2  ind60 =~    x2   0.973 0.017 58.858  0.000    0.941    1.006</span></span>
<span><span class="co">#&gt; 3  ind60 =~    x3   0.872 0.031 28.034  0.000    0.811    0.933</span></span>
<span><span class="co">#&gt; 4  dem60 =~    y1   0.845 0.039 21.698  0.000    0.769    0.921</span></span>
<span><span class="co">#&gt; 5  dem60 =~    y2   0.760 0.054 14.142  0.000    0.655    0.866</span></span>
<span><span class="co">#&gt; 6  dem60 =~    y3   0.705 0.063 11.225  0.000    0.582    0.828</span></span>
<span><span class="co">#&gt; 7  dem60 =~    y4   0.860 0.036 23.650  0.000    0.789    0.931</span></span>
<span><span class="co">#&gt; 8  dem65 =~    y5   0.803 0.046 17.602  0.000    0.714    0.893</span></span>
<span><span class="co">#&gt; 9  dem65 =~    y6   0.783 0.049 15.918  0.000    0.687    0.879</span></span>
<span><span class="co">#&gt; 10 dem65 =~    y7   0.819 0.043 19.122  0.000    0.735    0.903</span></span>
<span><span class="co">#&gt; 11 dem65 =~    y8   0.847 0.038 22.389  0.000    0.773    0.921</span></span>
<span><span class="co">#&gt; 12 dem60  ~ ind60   0.448 0.102  4.393  0.000    0.248    0.648</span></span>
<span><span class="co">#&gt; 13 dem65  ~ ind60   0.146 0.070  2.071  0.038    0.008    0.283</span></span>
<span><span class="co">#&gt; 14 dem65  ~ dem60   0.913 0.048 19.120  0.000    0.819    1.006</span></span>
<span><span class="co">#&gt; 15    x1 ~~    x1   0.154 0.042  3.636  0.000    0.071    0.238</span></span>
<span><span class="co">#&gt; 16    x2 ~~    x2   0.053 0.032  1.634  0.102   -0.010    0.116</span></span>
<span><span class="co">#&gt; 17    x3 ~~    x3   0.240 0.054  4.417  0.000    0.133    0.346</span></span>
<span><span class="co">#&gt; 18    y1 ~~    y1   0.286 0.066  4.348  0.000    0.157    0.415</span></span>
<span><span class="co">#&gt; 19    y2 ~~    y2   0.422 0.082  5.166  0.000    0.262    0.582</span></span>
<span><span class="co">#&gt; 20    y3 ~~    y3   0.503 0.089  5.676  0.000    0.329    0.676</span></span>
<span><span class="co">#&gt; 21    y4 ~~    y4   0.261 0.063  4.173  0.000    0.138    0.383</span></span>
<span><span class="co">#&gt; 22    y5 ~~    y5   0.355 0.073  4.842  0.000    0.211    0.499</span></span>
<span><span class="co">#&gt; 23    y6 ~~    y6   0.387 0.077  5.024  0.000    0.236    0.538</span></span>
<span><span class="co">#&gt; 24    y7 ~~    y7   0.329 0.070  4.696  0.000    0.192    0.467</span></span>
<span><span class="co">#&gt; 25    y8 ~~    y8   0.283 0.064  4.416  0.000    0.157    0.408</span></span>
<span><span class="co">#&gt; 26 ind60 ~~ ind60   1.000 0.000     NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 27 dem60 ~~ dem60   0.799 0.091  8.737  0.000    0.620    0.978</span></span>
<span><span class="co">#&gt; 28 dem65 ~~ dem65   0.026 0.046  0.579  0.562   -0.063    0.116</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mark Hok Chio Lai, Yixiao Li, Winnie Wing-Yee Tse, Gengrui Zhang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
