<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reliability of Factor Scores â€¢ R2spa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reliability of Factor Scores">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">R2spa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/R2spa.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical-interaction.html">Using Two-Stage Path Analysis with Definition Variables for Latent Interactions with Categorical Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/corrected-se.html">Corrected Standard Errors</a></li>
    <li><a class="dropdown-item" href="../articles/correction-error.html">Correction to Measurement Error</a></li>
    <li><a class="dropdown-item" href="../articles/efa-score.html">EFA Scores</a></li>
    <li><a class="dropdown-item" href="../articles/get_fs_int-vignette.html">get_fs_int-example</a></li>
    <li><a class="dropdown-item" href="../articles/gr-std-coef.html">Grand Standardized Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">2S-PA with Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-factors.html">Multi-Factor Measurement Model</a></li>
    <li><a class="dropdown-item" href="../articles/reliability.html">Reliability of Factor Scores</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-growth-vignette.html">Linear Growth Modeling with Two-Stage Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-plot-vignette.html">Diagnostic plots for `tspa` models</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-vignette-mx.html">Multi-Factor Measurement Model (OpenMx)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reliability of Factor Scores</h1>
                        <h4 data-toc-skip class="author">Yixiao Li,
Winnie Tse, Mark Lai</h4>
            
            <h4 data-toc-skip class="date">2024-09-06</h4>
      

      <div class="d-none name"><code>reliability.Rmd</code></div>
    </div>

    
    
<!--

TODO:

- [p] Implement the three reliability estimation (quadratic root method as experimental)
- [x] Perform a small-scale simulation
- [x] Write down math equations for all methods
- [ ] Theoretical exploration of added uncertainty due to (a) small sample and (b) number of items. 

-->
<p>In this vignette, we explore analytically the reliability of factor
scores, and evaluate them using simulated data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is lavaan 0.6-18</span></span>
<span><span class="co">## lavaan is FREE software! Please report any bugs.</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gengrui-zhang.github.io/R2spa/">R2spa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="analytic-formula-for-factor-scores">Analytic Formula for Factor Scores<a class="anchor" aria-label="anchor" href="#analytic-formula-for-factor-scores"></a>
</h2>
<div class="section level3">
<h3 id="theoretical-values">Theoretical Values<a class="anchor" aria-label="anchor" href="#theoretical-values"></a>
</h3>
<blockquote>
<p>aka, using true parameter values to compute weights</p>
</blockquote>
<p>From a unidimensional factor model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ²</mi><mo>=</mo><mi>ğ›Œ</mi><mi>Î·</mi><mo>+</mo><mi>ğ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\mathbf{y}}= \boldsymbol{\mathbf{\lambda }}\eta + \boldsymbol{\mathbf{e}}</annotation></semantics></math>,
for factor scores of the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>Î·</mi><mo accent="true">Ìƒ</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğš</mi><mi>â€²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo>âˆ’</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ğš</mi><mi>â€²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>+</mo><mi>ğ›Œ</mi><mi>Î·</mi><mo>+</mo><mi>ğ</mi><mo>âˆ’</mo><mi>ğ›</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mi>Î·</mi><mo>+</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \tilde \eta &amp; = \boldsymbol{\mathbf{a}}' (\boldsymbol{\mathbf{y}} - \hat {\boldsymbol{\mathbf{\mu}}}) = \boldsymbol{\mathbf{a}}' (\boldsymbol{\mathbf{\nu }}+ \boldsymbol{\mathbf{\lambda }}\eta + \boldsymbol{\mathbf{e}} - \boldsymbol{\mathbf{\nu}}) \\
  &amp; = \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda }}\eta + \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{e}},
\end{aligned}
</annotation></semantics></math></p>
<p>where we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>E</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathop{\mathrm{\mathrm{E}}}(\eta)</annotation></semantics></math>
= 0 so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat {\boldsymbol{\mathbf{\mu}}}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\nu}}</annotation></semantics></math>,
the theoretical reliability formula of factor scores, assuming no
sampling errors in the weights is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>ğš</mi><mi>â€²</mi><mi>ğš¯</mi><mi>ğš</mi></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\rho = \frac{(\boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda}})^2}{(\boldsymbol{\mathbf{a}}'\boldsymbol{\mathbf{\lambda}})^2 + \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{a}}},
</annotation></semantics></math></p>
<p>assuming that we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathop{\mathrm{\mathrm{Var}}}(\eta) = 1</annotation></semantics></math>.</p>
<div class="section level4">
<h4 id="regression-factor-scores">Regression factor scores<a class="anchor" aria-label="anchor" href="#regression-factor-scores"></a>
</h4>
<p>With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{a}}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\boldsymbol{\mathbf{\Sigma}}^{-1} \boldsymbol{\mathbf{\lambda}})</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Rel</mtext></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mi>ğ›Œ</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo>+</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğš¯</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>ğ›Œ</mi><mi>â€²</mi><mo>+</mo><mi>ğš¯</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğšº</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\text{Rel} 
&amp;= \frac{(\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Sigma}}^{-1} \boldsymbol{\mathbf{\lambda}})^2}{\boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda }}\boldsymbol{\mathbf{\lambda }}\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda }}+ \boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda}}} \\
&amp;= \frac{(\boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda}})^2}{\boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}(\boldsymbol{\mathbf{\lambda}}\boldsymbol{\mathbf{\lambda}}'+\boldsymbol{\mathbf{\Theta}})\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda}}} \\
&amp;= \frac{(\boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda}})^2}{\boldsymbol{\mathbf{\lambda}}'\boldsymbol{\mathbf{\Sigma}}^{-1}\boldsymbol{\mathbf{\lambda}}} \\
&amp;= \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda}}
\end{align*}
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="bartlett-factor-scores">Bartlett factor scores<a class="anchor" aria-label="anchor" href="#bartlett-factor-scores"></a>
</h4>
<p>With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{a}}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda }}(\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda}})^{-1}</annotation></semantics></math>,
and thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda }}= 1</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Rel</mtext></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğš¯</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›Œ</mi><mi>â€²</mi><msup><mi>ğš¯</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\text{Rel} 
&amp;= \frac{1}{1 + (\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda}})^{-1} \boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda }}(\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda}})^{-1}} \\
&amp;= \frac{1}{1 + (\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{\Theta}}^{-1} \boldsymbol{\mathbf{\lambda}})^{-1}}
\end{align*}
</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="sample-estimators">Sample Estimators<a class="anchor" aria-label="anchor" href="#sample-estimators"></a>
</h3>
<p>When factor scores are computed using sample estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›Œ</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\lambda}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¯</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\Theta}}</annotation></semantics></math>,
we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\mathbf{\mu}}}</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\mathbf{\nu}}}</annotation></semantics></math>,
and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>Î·</mi><mo accent="true">Ìƒ</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo>âˆ’</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>+</mo><mi>ğ›Œ</mi><mi>Î·</mi><mo>+</mo><mi>ğ</mi><mo>âˆ’</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mi>ğ›Œ</mi><mi>Î·</mi><mo>+</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>âˆ’</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mi>ğ</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \tilde \eta &amp; = \hat{\boldsymbol{\mathbf{a}}}' (\boldsymbol{\mathbf{y}} - \hat {\boldsymbol{\mathbf{\mu}}}) = \hat{\boldsymbol{\mathbf{a}}}' (\boldsymbol{\mathbf{\nu }}+ \boldsymbol{\mathbf{\lambda }}\eta + \boldsymbol{\mathbf{e}} - \hat{\boldsymbol{\mathbf{\nu}}}) \\
  &amp; = \hat{\boldsymbol{\mathbf{a}}}' \boldsymbol{\mathbf{\lambda }}\eta + \hat{\boldsymbol{\mathbf{a}}}'(\boldsymbol{\mathbf{\nu }}- \hat{\boldsymbol{\mathbf{\nu}}}) + \hat{\boldsymbol{\mathbf{a}}}' \boldsymbol{\mathbf{e}},
\end{aligned}
</annotation></semantics></math></p>
<p>where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\hat a}}</annotation></semantics></math>
= vector of estimated weights of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{a}}</annotation></semantics></math>
= vector of true weights of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ²</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{y}}</annotation></semantics></math>
= vector of observed scores of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
= vector of factor loadings of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î·</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
= latent variable,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{e}}</annotation></semantics></math>
= vector of measurement errors of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î˜</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathop{\mathrm{\mathrm{Var}}}(\boldsymbol{\mathbf{e}})</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p \times p</annotation></semantics></math>
variance-covariance matrix of errors,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
= number of items.</li>
</ul>
<p>If we assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\mathbf{a}}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\mathbf{\nu}}}</annotation></semantics></math>
are independent, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ğš</mi></mrow><annotation encoding="application/x-tex">E(\hat{\boldsymbol{\mathbf{a}}}) = \boldsymbol{\mathbf{a}}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub></mrow><annotation encoding="application/x-tex">\mathop{\mathrm{\mathrm{Var}}}(\hat{\boldsymbol{\mathbf{a}}}) = V_{\hat a}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ğ›</mi></mrow><annotation encoding="application/x-tex">E(\hat{\boldsymbol{\mathbf{\nu}}}) = \boldsymbol{\mathbf{\nu}}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub></mrow><annotation encoding="application/x-tex">\mathop{\mathrm{\mathrm{Var}}}(\hat{\boldsymbol{\mathbf{\nu}}}) = V_{\hat \nu}</annotation></semantics></math>,
then using law of total variance,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Î·</mi><mo accent="true">Ìƒ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>E</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>Var</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Î·</mi><mo accent="true">Ìƒ</mo></mover><mo stretchy="false" form="prefix">|</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>Var</mo><mrow><mo stretchy="true" form="prefix">[</mo><mo>E</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Î·</mi><mo accent="true">Ìƒ</mo></mover><mo stretchy="false" form="prefix">|</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>E</mo><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mi>ğ›Œ</mi><mi>ğ›Œ</mi><mi>â€²</mi><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo><mi>ğš</mi><mi>â€²</mi><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğš</mi><mo>+</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mi>ğš¯</mi><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mi>V</mi><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>ğš</mi><mo accent="true">Ì‚</mo></mover><mi>â€²</mi><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mi>ğ›Œ</mi><mi>â€²</mi><mi>ğš</mi><mo>+</mo><mo>Tr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğ›Œ</mi><mi>ğ›Œ</mi><mi>â€²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ğš</mi><mi>â€²</mi><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğš</mi><mo>+</mo><mo>Tr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ğš</mi><mi>â€²</mi><mi>ğš¯</mi><mi>ğš</mi><mo>+</mo><mo>Tr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğš¯</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \mathop{\mathrm{\mathrm{Var}}}(\tilde \eta) &amp; = \mathop{\mathrm{\mathrm{E}}}[\mathop{\mathrm{\mathrm{Var}}}(\tilde \eta | \hat{\boldsymbol{\mathbf{a}}})] + \mathop{\mathrm{\mathrm{Var}}}[\mathop{\mathrm{\mathrm{E}}}(\tilde \eta | \hat{\boldsymbol{\mathbf{a}}})] \\
  &amp; = \mathop{\mathrm{\mathrm{E}}}[\hat {\boldsymbol{\mathbf{a}}}' \boldsymbol{\mathbf{\lambda }}\boldsymbol{\mathbf{\lambda}}' \hat{\boldsymbol{\mathbf{a}}} + \boldsymbol{\mathbf{a}}' V_{\hat \nu} \boldsymbol{\mathbf{a}} + \hat {\boldsymbol{\mathbf{a}}}' \boldsymbol{\mathbf{\Theta }}\hat{\boldsymbol{\mathbf{a}}}] + V[\hat{\boldsymbol{\mathbf{a}}}' 0] \\
  &amp; = \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda }}\boldsymbol{\mathbf{\lambda}}' \boldsymbol{\mathbf{a}} + \mathop{\mathrm{\mathrm{Tr}}}(V_{\hat a} \boldsymbol{\mathbf{\lambda }}\boldsymbol{\mathbf{\lambda}}') + \boldsymbol{\mathbf{a}}' V_{\hat \nu} \boldsymbol{\mathbf{a}} + \mathop{\mathrm{\mathrm{Tr}}}(V_{\hat a} V_{\hat \nu}) + \boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{a}} + \mathop{\mathrm{\mathrm{Tr}}}(V_{\hat a} \boldsymbol{\mathbf{\Theta}})
\end{aligned}
</annotation></semantics></math></p>
<p>So, accounting for sampling error,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><mo>=</mo><mfrac><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>ğ›Œ</mi><mi>â€²</mi><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğ›Œ</mi></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğš</mi><mi>â€²</mi><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>ğš</mi><mi>â€²</mi><mi>ğš¯</mi><mi>ğš</mi><mo>+</mo><mi>ğ›Œ</mi><mi>â€²</mi><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğ›Œ</mi><mo>+</mo><mi>ğš</mi><mi>â€²</mi><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub><mi>ğš</mi><mo>+</mo><mo>Tr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><msub><mi>V</mi><mover><mi>Î½</mi><mo accent="true">Ì‚</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>Tr</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğš¯</mi><msub><mi>ğ•</mi><mover><mi>a</mi><mo accent="true">Ì‚</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\rho = \frac{(\boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda}})^2 + \boldsymbol{\mathbf{\lambda}}'V_{\hat a} \boldsymbol{\mathbf{\lambda}}}{(\boldsymbol{\mathbf{a}}' \boldsymbol{\mathbf{\lambda}})^2 + \boldsymbol{\mathbf{a}}'\boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{a}} + \boldsymbol{\mathbf{\lambda}}'V_{\hat a}\boldsymbol{\mathbf{\lambda }}+ \boldsymbol{\mathbf{a}}' V_{\hat \nu} \boldsymbol{\mathbf{a}} + \mathop{\mathrm{\mathrm{Tr}}}(V_{\hat a} V_{\hat \nu}) + \mathop{\mathrm{\mathrm{Tr}}}(\boldsymbol{\mathbf{\Theta }}\boldsymbol{\mathbf{V}}_{\hat a})}
</annotation></semantics></math></p>
<p>The sample estimates can be obtained by substituting in the sample
estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›Œ</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\lambda}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš¯</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{\Theta}}</annotation></semantics></math>
and using the corresponding form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğš</mi><annotation encoding="application/x-tex">\boldsymbol{\mathbf{a}}</annotation></semantics></math>.</p>
<div class="section level4">
<h4 id="quadratic-formula-for-regression-factor-scores">Quadratic formula for regression factor scores<a class="anchor" aria-label="anchor" href="#quadratic-formula-for-regression-factor-scores"></a>
</h4>
<p>The reliability formula for the regression factor scores derived
using a quadratic formula is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Rel</mtext><mo>=</mo><mfrac><mrow><mn>1</mn><mo>Â±</mo><msqrt><mrow><mn>1</mn><mo>âˆ’</mo><mn>4</mn><msub><mi>Î¸</mi><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msub><mi>/</mi><mi>Ïˆ</mi></mrow></msqrt></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\text{Rel} = \frac{1\pm\sqrt{1 - 4\theta_{corrected}/\psi}}{2}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¸</mi><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{corrected}</annotation></semantics></math>
is the corrected error term for the factor scores.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="empirical-example">Empirical Example<a class="anchor" aria-label="anchor" href="#empirical-example"></a>
</h2>
<div class="section level3">
<h3 id="regression-factor-scores-1">Regression Factor Scores<a class="anchor" aria-label="anchor" href="#regression-factor-scores-1"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Three items from the classic Holzinger and Swineford (1939) data</span></span>
<span><span class="va">cfa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  visual =~ x1 + x2 + x3</span></span>
<span><span class="st">"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">HolzingerSwineford1939</span>,</span>
<span>  std.lv <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Uncorrected reliability of regression factor scores</span></span>
<span><span class="va">fsr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">cfa_fit</span>, fsm <span class="op">=</span> <span class="cn">TRUE</span>, acov <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsr</span>, <span class="st">"fsm"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span><span class="op">$</span><span class="va">lambda</span></span></code></pre></div>
<pre><code><span><span class="co">##           visual</span></span>
<span><span class="co">## visual 0.6598382</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Empirical reliability of regression factor scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">fsr</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">fsr</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsr</span>, <span class="st">"acov"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           visual</span></span>
<span><span class="co">## visual 0.6605848</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Corrected reliability of regression factor scores</span></span>
<span><span class="va">get_a</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lambda</span>, <span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">+</span> <span class="va">theta</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">lam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span><span class="op">$</span><span class="va">lambda</span></span>
<span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="va">jac_a</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_func.html" class="external-link">lav_func_jacobian_complex</a></span><span class="op">(</span></span>
<span>  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">get_a</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lam</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Estimated sampling variance of weights</span></span>
<span><span class="va">va</span> <span class="op">&lt;-</span> <span class="va">jac_a</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">cfa_fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">jac_a</span><span class="op">)</span></span>
<span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="fu">get_a</span><span class="op">(</span><span class="va">lam</span>, <span class="va">th</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">va</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">cfa_fit</span><span class="op">@</span><span class="va">implied</span><span class="op">$</span><span class="va">cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.64774</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or using `get_fs_lavaan`</span></span>
<span><span class="fu"><a href="../reference/get_fs_lavaan.html">get_fs_lavaan</a></span><span class="op">(</span><span class="va">cfa_fit</span>, reliability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"reliability"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.64774</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="bartlett-factor-scores-1">Bartlett Factor Scores<a class="anchor" aria-label="anchor" href="#bartlett-factor-scores-1"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Uncorrected reliability of Bartlett factor scores</span></span>
<span><span class="va">fsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">cfa_fit</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span>, fsm <span class="op">=</span> <span class="cn">TRUE</span>, acov <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsb</span>, <span class="st">"acov"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           visual</span></span>
<span><span class="co">## visual 0.6598382</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Empirical reliability of regression factor scores</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">fsb</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsb</span>, <span class="st">"acov"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">fsb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           visual</span></span>
<span><span class="co">## visual 0.6609684</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Corrected reliability of regression factor scores</span></span>
<span><span class="va">get_a</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lambda</span>, <span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">thinv_lam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">thinv_lam</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">thinv_lam</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">lam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span><span class="op">$</span><span class="va">lambda</span></span>
<span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">cfa_fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="va">jac_a</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_func.html" class="external-link">lav_func_jacobian_complex</a></span><span class="op">(</span></span>
<span>  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">get_a</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lam</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Estimated sampling variance of weights</span></span>
<span><span class="va">va</span> <span class="op">&lt;-</span> <span class="va">jac_a</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">cfa_fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">jac_a</span><span class="op">)</span></span>
<span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">get_a</span><span class="op">(</span><span class="va">lam</span>, <span class="va">th</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">va</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">cfa_fit</span><span class="op">@</span><span class="va">implied</span><span class="op">$</span><span class="va">cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6477805</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or using `get_fs_lavaan` (need to be fixed)</span></span>
<span><span class="fu">R2spa</span><span class="fu">::</span><span class="fu"><a href="../reference/get_fs_lavaan.html">get_fs_lavaan</a></span><span class="op">(</span><span class="va">cfa_fit</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span>, reliability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"reliability"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6477805</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multiple-group-example">Multiple-group example<a class="anchor" aria-label="anchor" href="#multiple-group-example"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  visual =~ x1 + x2 + x3</span></span>
<span><span class="st">"</span></span>
<span><span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">HolzingerSwineford1939</span>, model <span class="op">=</span> <span class="va">mod</span>, group <span class="op">=</span> <span class="st">"school"</span>,</span>
<span>       reliability <span class="op">=</span> <span class="cn">TRUE</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"reliability"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $Pasteur</span></span>
<span><span class="co">## [1] 0.6473336</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Grant-White`</span></span>
<span><span class="co">## [1] 0.6789831</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $overall</span></span>
<span><span class="co">## [1] 0.66258</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">HolzingerSwineford1939</span>, model <span class="op">=</span> <span class="va">mod</span>, group <span class="op">=</span> <span class="st">"school"</span>,</span>
<span>       reliability <span class="op">=</span> <span class="cn">TRUE</span>, std.lv <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"reliability"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $Pasteur</span></span>
<span><span class="co">## [1] 0.6474885</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Grant-White`</span></span>
<span><span class="co">## [1] 0.6790979</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $overall</span></span>
<span><span class="co">## [1] 0.6627156</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2356</span><span class="op">)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.9</span>, length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">num_obs</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">num_sims</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">7</span>, nrow <span class="op">=</span> <span class="va">num_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Copy function for computing a</span></span>
<span><span class="va">get_a</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lambda</span>, <span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">+</span> <span class="va">theta</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function for getting all versions</span></span>
<span><span class="va">all_rel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lam</span>, <span class="va">th</span>, <span class="va">vc</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op">+</span> <span class="va">th</span></span>
<span>  <span class="va">ahat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">lam</span>, <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Formula 1: no adjustment</span></span>
<span>  <span class="va">rel1</span> <span class="op">&lt;-</span> <span class="va">ahat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lam</span></span>
<span></span>
<span>  <span class="va">jac_a</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_func.html" class="external-link">lav_func_jacobian_complex</a></span><span class="op">(</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">get_a</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">]</span>, theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lam</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">va</span> <span class="op">&lt;-</span> <span class="va">jac_a</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">vc</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">jac_a</span><span class="op">)</span></span>
<span>  <span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">ahat</span><span class="op">)</span> <span class="op">+</span> <span class="va">va</span></span>
<span>  <span class="co"># Formula 2: adjust for both error in weights and true variances</span></span>
<span>  <span class="va">rel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">ev_fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">th</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">aa</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Formula 3: solve quadratic equation with adjusted error</span></span>
<span>  <span class="va">rel3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">ev_fs</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rel1</span>, <span class="va">rel2</span>, <span class="va">rel3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function for getting all bias-corrected versions</span></span>
<span><span class="va">all_bc_rel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">nsim</span> <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="va">mc_sim</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">nsim</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">vc</span><span class="op">)</span></span>
<span>  <span class="va">mc_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mc_sim</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                    <span class="fu">all_rel</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, th <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span>, vc <span class="op">=</span> <span class="va">vc</span><span class="op">)</span></span>
<span>                  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span>,</span>
<span>    <span class="fu">all_rel</span><span class="op">(</span><span class="va">lambda</span>, th <span class="op">=</span> <span class="va">theta</span>, vc <span class="op">=</span> <span class="va">vc</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">mc_rel</span><span class="op">)</span> <span class="co"># bias-corrected</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">num_sims</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span><span class="op">)</span></span>
<span>  <span class="va">err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="va">num_obs</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">eta</span><span class="op">)</span> <span class="op">+</span> <span class="va">err</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Run cfa</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"f =~ y1 + y2 + y3 + y4 + y5 + y6"</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    std.lv <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">pars_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span></span>
<span>  <span class="va">tilde_eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">fit</span>, fsm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">true_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">tilde_eta</span>, <span class="va">eta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="va">est_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tilde_eta</span>, <span class="st">"fsm"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">out</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">true_rel</span>,</span>
<span>    <span class="fu">all_rel</span><span class="op">(</span><span class="va">pars_fit</span><span class="op">$</span><span class="va">lambda</span>, <span class="va">pars_fit</span><span class="op">$</span><span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">all_bc_rel</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">setTxtProgressBar</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">txtProgressBar</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">num_sims</span>, style <span class="op">=</span> <span class="fl">3</span>, width <span class="op">=</span> <span class="fl">50</span>, char <span class="op">=</span> <span class="st">"="</span><span class="op">)</span>, </span>
<span>    <span class="va">i</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"true_rel"</span>, <span class="st">"no_adj_rel"</span>, <span class="st">"adj_rel"</span>, <span class="st">"quadratic"</span>,</span>
<span>                   <span class="st">"no_adj_rel_bc"</span>, <span class="st">"adj_rel_bc"</span>, <span class="st">"quadratic_bc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save the file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"vignettes/sim_results_reliability.RDS"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean bias</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"sim_results_reliability.RDS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no_adj_rel"</span>, <span class="st">"adj_rel"</span>, <span class="st">"quadratic"</span>,</span>
<span>           <span class="st">"no_adj_rel_bc"</span>, <span class="st">"adj_rel_bc"</span>, <span class="st">"quadratic_bc"</span><span class="op">)</span>,</span>
<span>  Raw_Biases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"no_adj_rel"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"adj_rel"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"quadratic"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"no_adj_rel_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"adj_rel_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"quadratic_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="right">Raw_Biases</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">no_adj_rel</td>
<td align="right">0.019</td>
</tr>
<tr class="even">
<td align="left">adj_rel</td>
<td align="right">0.011</td>
</tr>
<tr class="odd">
<td align="left">quadratic</td>
<td align="right">0.008</td>
</tr>
<tr class="even">
<td align="left">no_adj_rel_bc</td>
<td align="right">0.012</td>
</tr>
<tr class="odd">
<td align="left">adj_rel_bc</td>
<td align="right">0.005</td>
</tr>
<tr class="even">
<td align="left">quadratic_bc</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># RMSE: </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no_adj_rel"</span>, <span class="st">"adj_rel"</span>, <span class="st">"quadratic"</span>,</span>
<span>           <span class="st">"no_adj_rel_bc"</span>, <span class="st">"adj_rel_bc"</span>, <span class="st">"quadratic_bc"</span><span class="op">)</span>,</span>
<span>  RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"no_adj_rel"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"adj_rel"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"quadratic"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"no_adj_rel_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"adj_rel_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="st">"quadratic_bc"</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="st">"true_rel"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                     na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="right">RMSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">no_adj_rel</td>
<td align="right">0.046</td>
</tr>
<tr class="even">
<td align="left">adj_rel</td>
<td align="right">0.042</td>
</tr>
<tr class="odd">
<td align="left">quadratic</td>
<td align="right">0.042</td>
</tr>
<tr class="even">
<td align="left">no_adj_rel_bc</td>
<td align="right">0.042</td>
</tr>
<tr class="odd">
<td align="left">adj_rel_bc</td>
<td align="right">0.040</td>
</tr>
<tr class="even">
<td align="left">quadratic_bc</td>
<td align="right">0.040</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boxplot to compare the bias across formula</span></span>
<span><span class="va">bias_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"formula"</span>, values_to <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span></span>
<span><span class="va">bias_tab</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">formula</span>, y <span class="op">=</span> <span class="va">bias</span>, col <span class="op">=</span> <span class="va">formula</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<p><img src="reliability_files/figure-html/unnamed-chunk-9-1.png" width="80%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Hok Chio Lai, Yixiao Li, Winnie Wing-Yee Tse, Gengrui Zhang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
