<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>get_fs_int-example â€¢ R2spa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="get_fs_int-example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">R2spa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/R2spa.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical-interaction.html">Using Two-Stage Path Analysis with Definition Variables for Latent Interactions with Categorical Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/corrected-se.html">Corrected Standard Errors</a></li>
    <li><a class="dropdown-item" href="../articles/correction-error.html">Correction to Measurement Error</a></li>
    <li><a class="dropdown-item" href="../articles/efa-score.html">EFA Scores</a></li>
    <li><a class="dropdown-item" href="../articles/get_fs_int-vignette.html">get_fs_int-example</a></li>
    <li><a class="dropdown-item" href="../articles/gr-std-coef.html">Grand Standardized Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">2S-PA with Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-factors.html">Multi-Factor Measurement Model</a></li>
    <li><a class="dropdown-item" href="../articles/reliability.html">Reliability of Factor Scores</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-growth-vignette.html">Linear Growth Modeling with Two-Stage Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-plot-vignette.html">Diagnostic plots for `tspa` models</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-vignette-mx.html">Multi-Factor Measurement Model (OpenMx)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>get_fs_int-example</h1>
                        <h4 data-toc-skip class="author">Jimmy
Zhang</h4>
            
            <h4 data-toc-skip class="date">2024-09-06</h4>
      

      <div class="d-none name"><code>get_fs_int-vignette.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-18</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gengrui-zhang.github.io/R2spa/">R2spa</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="get_fs_int-function">
<code>get_fs_int</code> Function<a class="anchor" aria-label="anchor" href="#get_fs_int-function"></a>
</h2>
<p>This function is designed to create product indicators for
first-order factor score indicators with standard errors and
model-implied loadings. With a specified model, the product indicator
pairs will be generated based on the model syntax; without a specified
model, the function will by default generate all possible pairs of
product indicators.</p>
</div>
<div class="section level2">
<h2 id="illustrative-example">Illustrative Example<a class="anchor" aria-label="anchor" href="#illustrative-example"></a>
</h2>
<p>We will simulate a dataset with four firsr-order latent variables: x,
m, z, y</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2116</span><span class="op">)</span></span>
<span><span class="co">## Sample size:</span></span>
<span><span class="va">num_obs</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span></span>
<span><span class="co"># Structural Parameters: </span></span>
<span><span class="co">## gamma_x = 0.3, gamma_m = 0.4, gamma_z = 0.2</span></span>
<span><span class="co">## gamma_xm = 0.1, gamma_xz = 0.15, gamma_mz = 0.12</span></span>
<span></span>
<span><span class="co"># Correlation between latent variables:</span></span>
<span><span class="co">## cor_xm = 0.2, cor_xz = 0.3, cor_zm = 0.4</span></span>
<span></span>
<span><span class="co"># Data simulation: </span></span>
<span><span class="co">## x, z, m, ey</span></span>
<span><span class="va">cov_xmz_ey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0</span>,</span>
<span>                       <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">0.12</span>, <span class="fl">0</span>,</span>
<span>                       <span class="fl">0.15</span>, <span class="fl">0.12</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span>
<span>                       <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.481351</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">num_obs</span>,</span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">cov_xmz_ey</span>,</span>
<span>    empirical <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"m"</span>, <span class="st">"z"</span>, <span class="st">"ey"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># xm, xz, mz</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">eta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span>
<span>    xm <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="va">m</span>,</span>
<span>    xz <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="va">z</span>,</span>
<span>    mz <span class="op">=</span> <span class="va">m</span> <span class="op">*</span> <span class="va">z</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># y</span></span>
<span><span class="va">etay</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">m</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">z</span> <span class="op">+</span></span>
<span>  <span class="fl">0.1</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">xm</span> <span class="op">+</span> <span class="fl">0.15</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">xz</span> <span class="op">+</span> <span class="fl">0.12</span> <span class="op">*</span> <span class="va">eta</span><span class="op">$</span><span class="va">mz</span> <span class="op">+</span> <span class="va">eta</span><span class="op">$</span><span class="va">ey</span></span>
<span></span>
<span><span class="co"># Observed Indicators</span></span>
<span><span class="va">lambda_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">lambda_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.75</span>, <span class="fl">0.65</span><span class="op">)</span></span>
<span><span class="va">lambda_z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">lambda_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.7</span>, <span class="fl">0.65</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_obs</span> <span class="op">&lt;-</span> <span class="va">eta</span><span class="op">$</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">lambda_x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lambda_x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m_obs</span> <span class="op">&lt;-</span> <span class="va">eta</span><span class="op">$</span><span class="va">m</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">lambda_m</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lambda_m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z_obs</span> <span class="op">&lt;-</span> <span class="va">eta</span><span class="op">$</span><span class="va">z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">lambda_z</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lambda_z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y_obs</span> <span class="op">&lt;-</span> <span class="va">etay</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">lambda_y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">num_obs</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lambda_z</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dataset: raw score</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x_obs</span>, <span class="va">m_obs</span>, <span class="va">z_obs</span>, <span class="va">y_obs</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Obtain factor scores using <code><a href="../reference/get_fs.html">get_fs()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">df</span>, model <span class="op">=</span> <span class="st">"x =~ x1 + x2 + x3</span></span>
<span><span class="st">                              m =~ m1 + m2 + m3</span></span>
<span><span class="st">                              z =~ z1 + z2 + z3</span></span>
<span><span class="st">                              y =~ y1 + y2 + y3"</span>,</span>
<span>                 std.lv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"Bartlett"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fs_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;          fs_x       fs_m       fs_z       fs_y   fs_x_se   fs_m_se   fs_z_se</span></span>
<span><span class="co">#&gt; 1 -1.57082033  0.5158033 -2.4166532  0.6803742 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 2 -1.28761379  1.5073520 -1.2254840  0.6479675 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 3  1.05055317  1.3509779  0.9886338 -1.0717407 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 4 -1.24981810 -0.4465930 -1.1941697 -0.2898219 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 5  0.03723966 -2.0745305 -0.7534680  0.8267039 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 6 -0.30949355  0.3911142 -0.6878682 -1.2723421 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt;     fs_y_se x_by_fs_x x_by_fs_m x_by_fs_z x_by_fs_y m_by_fs_x m_by_fs_m</span></span>
<span><span class="co">#&gt; 1 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 2 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 3 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 4 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 5 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 6 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt;   m_by_fs_z m_by_fs_y z_by_fs_x z_by_fs_m z_by_fs_z z_by_fs_y y_by_fs_x</span></span>
<span><span class="co">#&gt; 1         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 2         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 3         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 4         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 5         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 6         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt;   y_by_fs_m y_by_fs_z y_by_fs_y   ev_fs_x ecov_fs_m_fs_x   ev_fs_m</span></span>
<span><span class="co">#&gt; 1         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 2         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 3         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 4         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 5         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 6         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt;   ecov_fs_z_fs_x ecov_fs_z_fs_m   ev_fs_z ecov_fs_y_fs_x ecov_fs_y_fs_m</span></span>
<span><span class="co">#&gt; 1              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 2              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 3              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 4              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 5              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 6              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt;   ecov_fs_y_fs_z   ev_fs_y</span></span>
<span><span class="co">#&gt; 1              0 0.8163963</span></span>
<span><span class="co">#&gt; 2              0 0.8163963</span></span>
<span><span class="co">#&gt; 3              0 0.8163963</span></span>
<span><span class="co">#&gt; 4              0 0.8163963</span></span>
<span><span class="co">#&gt; 5              0 0.8163963</span></span>
<span><span class="co">#&gt; 6              0 0.8163963</span></span></code></pre></div>
<p>Obtain product-indicator of factor scores, and the corresponding
standard errors. Double-mean-centering is used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With specified model</span></span>
<span><span class="va">ind_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs_int.html">get_fs_int</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">fs_dat</span>,</span>
<span>                    fs_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_x"</span>, <span class="st">"fs_m"</span>, <span class="st">"fs_z"</span><span class="op">)</span>,</span>
<span>                    se_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_x_se"</span>, <span class="st">"fs_m_se"</span>, <span class="st">"fs_z_se"</span><span class="op">)</span>,</span>
<span>                    loading_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_by_fs_x"</span>, <span class="st">"m_by_fs_m"</span>, <span class="st">"z_by_fs_z"</span><span class="op">)</span>,</span>
<span>                    model <span class="op">=</span> <span class="st">"fs_x:fs_m + fs_x:fs_z"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ind_1</span><span class="op">)</span></span>
<span><span class="co">#&gt;          fs_x       fs_m       fs_z       fs_y   fs_x_se   fs_m_se   fs_z_se</span></span>
<span><span class="co">#&gt; 1 -1.57082033  0.5158033 -2.4166532  0.6803742 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 2 -1.28761379  1.5073520 -1.2254840  0.6479675 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 3  1.05055317  1.3509779  0.9886338 -1.0717407 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 4 -1.24981810 -0.4465930 -1.1941697 -0.2898219 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 5  0.03723966 -2.0745305 -0.7534680  0.8267039 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 6 -0.30949355  0.3911142 -0.6878682 -1.2723421 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt;     fs_y_se x_by_fs_x x_by_fs_m x_by_fs_z x_by_fs_y m_by_fs_x m_by_fs_m</span></span>
<span><span class="co">#&gt; 1 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 2 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 3 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 4 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 5 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 6 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt;   m_by_fs_z m_by_fs_y z_by_fs_x z_by_fs_m z_by_fs_z z_by_fs_y y_by_fs_x</span></span>
<span><span class="co">#&gt; 1         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 2         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 3         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 4         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 5         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 6         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt;   y_by_fs_m y_by_fs_z y_by_fs_y   ev_fs_x ecov_fs_m_fs_x   ev_fs_m</span></span>
<span><span class="co">#&gt; 1         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 2         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 3         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 4         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 5         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 6         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt;   ecov_fs_z_fs_x ecov_fs_z_fs_m   ev_fs_z ecov_fs_y_fs_x ecov_fs_y_fs_m</span></span>
<span><span class="co">#&gt; 1              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 2              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 3              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 4              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 5              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 6              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt;   ecov_fs_y_fs_z   ev_fs_y  fs_x:fs_m fs_x:fs_m_se fs_x:fs_m_ld  fs_x:fs_z</span></span>
<span><span class="co">#&gt; 1              0 0.8163963 -0.9160818     1.164992            1  3.6292445</span></span>
<span><span class="co">#&gt; 2              0 0.8163963 -2.0467348     1.164992            1  1.4110667</span></span>
<span><span class="co">#&gt; 3              0 0.8163963  1.3134266     1.164992            1  0.8717289</span></span>
<span><span class="co">#&gt; 4              0 0.8163963  0.4523125     1.164992            1  1.3256114</span></span>
<span><span class="co">#&gt; 5              0 0.8163963 -0.1831024     1.164992            1 -0.1949424</span></span>
<span><span class="co">#&gt; 6              0 0.8163963 -0.2268949     1.164992            1  0.0460073</span></span>
<span><span class="co">#&gt;   fs_x:fs_z_se fs_x:fs_z_ld</span></span>
<span><span class="co">#&gt; 1     1.194246            1</span></span>
<span><span class="co">#&gt; 2     1.194246            1</span></span>
<span><span class="co">#&gt; 3     1.194246            1</span></span>
<span><span class="co">#&gt; 4     1.194246            1</span></span>
<span><span class="co">#&gt; 5     1.194246            1</span></span>
<span><span class="co">#&gt; 6     1.194246            1</span></span>
<span></span>
<span><span class="co"># Without specified model</span></span>
<span><span class="va">ind_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs_int.html">get_fs_int</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">fs_dat</span>,</span>
<span>                    fs_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_x"</span>, <span class="st">"fs_m"</span>, <span class="st">"fs_z"</span><span class="op">)</span>,</span>
<span>                    se_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_x_se"</span>, <span class="st">"fs_m_se"</span>, <span class="st">"fs_z_se"</span><span class="op">)</span>,</span>
<span>                    loading_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_by_fs_x"</span>, <span class="st">"m_by_fs_m"</span>, <span class="st">"z_by_fs_z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ind_2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          fs_x       fs_m       fs_z       fs_y   fs_x_se   fs_m_se   fs_z_se</span></span>
<span><span class="co">#&gt; 1 -1.57082033  0.5158033 -2.4166532  0.6803742 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 2 -1.28761379  1.5073520 -1.2254840  0.6479675 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 3  1.05055317  1.3509779  0.9886338 -1.0717407 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 4 -1.24981810 -0.4465930 -1.1941697 -0.2898219 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 5  0.03723966 -2.0745305 -0.7534680  0.8267039 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt; 6 -0.30949355  0.3911142 -0.6878682 -1.2723421 0.7007543 0.7621661 0.7919491</span></span>
<span><span class="co">#&gt;     fs_y_se x_by_fs_x x_by_fs_m x_by_fs_z x_by_fs_y m_by_fs_x m_by_fs_m</span></span>
<span><span class="co">#&gt; 1 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 2 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 3 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 4 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 5 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt; 6 0.9035465         1         0         0         0         0         1</span></span>
<span><span class="co">#&gt;   m_by_fs_z m_by_fs_y z_by_fs_x z_by_fs_m z_by_fs_z z_by_fs_y y_by_fs_x</span></span>
<span><span class="co">#&gt; 1         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 2         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 3         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 4         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 5         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt; 6         0         0         0         0         1         0         0</span></span>
<span><span class="co">#&gt;   y_by_fs_m y_by_fs_z y_by_fs_y   ev_fs_x ecov_fs_m_fs_x   ev_fs_m</span></span>
<span><span class="co">#&gt; 1         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 2         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 3         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 4         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 5         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt; 6         0         0         1 0.4910567              0 0.5808972</span></span>
<span><span class="co">#&gt;   ecov_fs_z_fs_x ecov_fs_z_fs_m   ev_fs_z ecov_fs_y_fs_x ecov_fs_y_fs_m</span></span>
<span><span class="co">#&gt; 1              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 2              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 3              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 4              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 5              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt; 6              0              0 0.6271834              0              0</span></span>
<span><span class="co">#&gt;   ecov_fs_y_fs_z   ev_fs_y  fs_x:fs_m fs_x:fs_m_se fs_x:fs_m_ld  fs_x:fs_z</span></span>
<span><span class="co">#&gt; 1              0 0.8163963 -0.9160818     1.164992            1  3.6292445</span></span>
<span><span class="co">#&gt; 2              0 0.8163963 -2.0467348     1.164992            1  1.4110667</span></span>
<span><span class="co">#&gt; 3              0 0.8163963  1.3134266     1.164992            1  0.8717289</span></span>
<span><span class="co">#&gt; 4              0 0.8163963  0.4523125     1.164992            1  1.3256114</span></span>
<span><span class="co">#&gt; 5              0 0.8163963 -0.1831024     1.164992            1 -0.1949424</span></span>
<span><span class="co">#&gt; 6              0 0.8163963 -0.2268949     1.164992            1  0.0460073</span></span>
<span><span class="co">#&gt;   fs_x:fs_z_se fs_x:fs_z_ld  fs_m:fs_z fs_m:fs_z_se fs_m:fs_z_ld</span></span>
<span><span class="co">#&gt; 1     1.194246            1 -1.3748087     1.253958            1</span></span>
<span><span class="co">#&gt; 2     1.194246            1 -1.9755270     1.253958            1</span></span>
<span><span class="co">#&gt; 3     1.194246            1  1.2073313     1.253958            1</span></span>
<span><span class="co">#&gt; 4     1.194246            1  0.4050167     1.253958            1</span></span>
<span><span class="co">#&gt; 5     1.194246            1  1.4348013     1.253958            1</span></span>
<span><span class="co">#&gt; 6     1.194246            1 -0.3973261     1.253958            1</span></span></code></pre></div>
<div class="section level3">
<h3 id="s-pa-with-product-factor-score-indicator">2S-PA with product factor score indicator<a class="anchor" aria-label="anchor" href="#s-pa-with-product-factor-score-indicator"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename product factor scores to be used with `tspa()`</span></span>
<span><span class="va">ind_2</span><span class="op">$</span><span class="va">fs_xm</span> <span class="op">&lt;-</span> <span class="va">ind_2</span><span class="op">$</span><span class="va">`fs_x:fs_m`</span></span>
<span><span class="va">ind_2</span><span class="op">$</span><span class="va">fs_xz</span> <span class="op">&lt;-</span> <span class="va">ind_2</span><span class="op">$</span><span class="va">`fs_x:fs_z`</span></span>
<span><span class="va">ind_2</span><span class="op">$</span><span class="va">fs_mz</span> <span class="op">&lt;-</span> <span class="va">ind_2</span><span class="op">$</span><span class="va">`fs_m:fs_z`</span></span>
<span><span class="va">tspa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa.html">tspa</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  y ~ x + m + z + xm + xz + mz</span></span>
<span><span class="st">"</span>, data <span class="op">=</span> <span class="va">ind_2</span>,</span>
<span>  se_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_y_se"</span><span class="op">]</span>,</span>
<span>    x <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_x_se"</span><span class="op">]</span>,</span>
<span>    m <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_m_se"</span><span class="op">]</span>,</span>
<span>    z <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_z_se"</span><span class="op">]</span>,</span>
<span>    xm <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_x:fs_m_se"</span><span class="op">]</span>,</span>
<span>    xz <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_x:fs_z_se"</span><span class="op">]</span>,</span>
<span>    mz <span class="op">=</span> <span class="va">ind_2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_m:fs_z_se"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedSolution</a></span><span class="op">(</span><span class="va">tspa_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs est.std    se       z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1      y =~  fs_y   0.742 0.006 122.490  0.000    0.730    0.754</span></span>
<span><span class="co">#&gt; 2      x =~  fs_x   0.819 0.004 203.643  0.000    0.811    0.827</span></span>
<span><span class="co">#&gt; 3      m =~  fs_m   0.795 0.005 172.148  0.000    0.786    0.804</span></span>
<span><span class="co">#&gt; 4      z =~  fs_z   0.784 0.005 159.443  0.000    0.774    0.794</span></span>
<span><span class="co">#&gt; 5     xm =~ fs_xm   0.662 0.008  77.988  0.000    0.645    0.679</span></span>
<span><span class="co">#&gt; 6     xz =~ fs_xz   0.649 0.009  72.742  0.000    0.631    0.666</span></span>
<span><span class="co">#&gt; 7     mz =~ fs_mz   0.651 0.009  73.382  0.000    0.633    0.668</span></span>
<span><span class="co">#&gt; 8   fs_y ~~  fs_y   0.449 0.009  50.000  0.000    0.432    0.467</span></span>
<span><span class="co">#&gt; 9   fs_x ~~  fs_x   0.329 0.007  50.000  0.000    0.316    0.342</span></span>
<span><span class="co">#&gt; 10  fs_m ~~  fs_m   0.367 0.007  50.000  0.000    0.353    0.382</span></span>
<span><span class="co">#&gt; 11  fs_z ~~  fs_z   0.385 0.008  50.000  0.000    0.370    0.401</span></span>
<span><span class="co">#&gt; 12 fs_xm ~~ fs_xm   0.562 0.011  50.000  0.000    0.540    0.584</span></span>
<span><span class="co">#&gt; 13 fs_xz ~~ fs_xz   0.579 0.012  50.000  0.000    0.556    0.602</span></span>
<span><span class="co">#&gt; 14 fs_mz ~~ fs_mz   0.577 0.012  50.000  0.000    0.554    0.599</span></span>
<span><span class="co">#&gt; 15     y  ~     x   0.341 0.022  15.484  0.000    0.298    0.385</span></span>
<span><span class="co">#&gt; 16     y  ~     m   0.406 0.022  18.561  0.000    0.363    0.448</span></span>
<span><span class="co">#&gt; 17     y  ~     z   0.189 0.023   8.056  0.000    0.143    0.235</span></span>
<span><span class="co">#&gt; 18     y  ~    xm   0.062 0.030   2.037  0.042    0.002    0.122</span></span>
<span><span class="co">#&gt; 19     y  ~    xz   0.178 0.029   6.106  0.000    0.121    0.236</span></span>
<span><span class="co">#&gt; 20     y  ~    mz   0.083 0.030   2.740  0.006    0.024    0.143</span></span>
<span><span class="co">#&gt; 21     y ~~     y   0.556 0.025  22.657  0.000    0.508    0.604</span></span>
<span><span class="co">#&gt; 22     x ~~     x   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 23     m ~~     m   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 24     z ~~     z   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 25    xm ~~    xm   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 26    xz ~~    xz   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 27    mz ~~    mz   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 28     x ~~     m   0.106 0.022   4.907  0.000    0.064    0.148</span></span>
<span><span class="co">#&gt; 29     x ~~     z   0.167 0.022   7.699  0.000    0.124    0.209</span></span>
<span><span class="co">#&gt; 30     x ~~    xm  -0.030 0.026  -1.157  0.247   -0.081    0.021</span></span>
<span><span class="co">#&gt; 31     x ~~    xz  -0.067 0.027  -2.520  0.012   -0.119   -0.015</span></span>
<span><span class="co">#&gt; 32     x ~~    mz   0.027 0.027   1.007  0.314   -0.025    0.079</span></span>
<span><span class="co">#&gt; 33     m ~~     z   0.128 0.022   5.708  0.000    0.084    0.172</span></span>
<span><span class="co">#&gt; 34     m ~~    xm   0.034 0.027   1.256  0.209   -0.019    0.086</span></span>
<span><span class="co">#&gt; 35     m ~~    xz   0.028 0.027   1.029  0.304   -0.026    0.082</span></span>
<span><span class="co">#&gt; 36     m ~~    mz  -0.013 0.027  -0.491  0.624   -0.067    0.040</span></span>
<span><span class="co">#&gt; 37     z ~~    xm   0.028 0.027   1.024  0.306   -0.026    0.081</span></span>
<span><span class="co">#&gt; 38     z ~~    xz   0.047 0.028   1.701  0.089   -0.007    0.102</span></span>
<span><span class="co">#&gt; 39     z ~~    mz   0.028 0.028   1.017  0.309   -0.026    0.083</span></span>
<span><span class="co">#&gt; 40    xm ~~    xz   0.213 0.033   6.544  0.000    0.149    0.277</span></span>
<span><span class="co">#&gt; 41    xm ~~    mz   0.282 0.032   8.769  0.000    0.219    0.345</span></span>
<span><span class="co">#&gt; 42    xz ~~    mz   0.173 0.033   5.204  0.000    0.108    0.238</span></span></code></pre></div>
<p>The above example assumes that the factor scores are obtained from a
model where the latent variances are assumed to be 1. If that is not the
case, users should specify the corresponding latent variance estimate
from the model, as in the following example, with the factor scores
obtained from separate measurement models.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mody</span> <span class="op">&lt;-</span> <span class="st">"y =~ y1 + y2 + y3"</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="st">"x =~ x1 + x2 + x3"</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="st">"m =~ m1 + m2 + m3"</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="st">"z =~ z1 + z2 + z3"</span></span>
<span><span class="va">cfay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mody</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">cfa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod1</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">cfa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod2</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">cfa3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="va">mod3</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="co"># Latent variances</span></span>
<span><span class="op">(</span><span class="va">lat_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cfa1</span>, <span class="va">cfa2</span>, <span class="va">cfa3</span><span class="op">)</span>,</span>
<span>                   FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavInspect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"cov.lv"</span><span class="op">)</span>,</span>
<span>                   FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8296271 0.7118338 0.6750885</span></span>
<span><span class="va">fs_dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cfay</span>, <span class="va">cfa1</span>, <span class="va">cfa2</span>, <span class="va">cfa3</span><span class="op">)</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">augment_lav_predict</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Bartlett"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what <span class="op">=</span> <span class="va">cbind</span><span class="op">)</span></span>
<span><span class="co"># With user-specified latent variance</span></span>
<span><span class="va">ind_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs_int.html">get_fs_int</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">fs_dat2</span>,</span>
<span>                    fs_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_x"</span>, <span class="st">"fs_m"</span>, <span class="st">"fs_z"</span><span class="op">)</span>,</span>
<span>                    se_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"se_fs_x"</span>, <span class="st">"se_fs_m"</span>, <span class="st">"se_fs_z"</span><span class="op">)</span>,</span>
<span>                    lat_var <span class="op">=</span> <span class="va">lat_var</span>,</span>
<span>                    loading_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_by_fs_x"</span>, <span class="st">"m_by_fs_m"</span>, <span class="st">"z_by_fs_z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ind_3</span><span class="op">)</span></span>
<span><span class="co">#&gt;         fs_y   se_fs_y y_by_fs_y   ev_fs_y        fs_x   se_fs_x x_by_fs_x</span></span>
<span><span class="co">#&gt; 1  0.4575840 0.6283493         1 0.3948229 -1.42777196 0.6396597         1</span></span>
<span><span class="co">#&gt; 2  0.4401277 0.6283493         1 0.3948229 -1.17905836 0.6396597         1</span></span>
<span><span class="co">#&gt; 3 -0.7629969 0.6283493         1 0.3948229  0.94924494 0.6396597         1</span></span>
<span><span class="co">#&gt; 4 -0.1888135 0.6283493         1 0.3948229 -1.13986480 0.6396597         1</span></span>
<span><span class="co">#&gt; 5  0.5901120 0.6283493         1 0.3948229  0.04530066 0.6396597         1</span></span>
<span><span class="co">#&gt; 6 -0.9137330 0.6283493         1 0.3948229 -0.30930312 0.6396597         1</span></span>
<span><span class="co">#&gt;     ev_fs_x       fs_m   se_fs_m m_by_fs_m   ev_fs_m       fs_z   se_fs_z</span></span>
<span><span class="co">#&gt; 1 0.4091646  0.4518302 0.6441129         1 0.4148814 -1.9838745 0.6533299</span></span>
<span><span class="co">#&gt; 2 0.4091646  1.2746252 0.6441129         1 0.4148814 -0.9859401 0.6533299</span></span>
<span><span class="co">#&gt; 3 0.4091646  1.1487800 0.6441129         1 0.4148814  0.8175038 0.6533299</span></span>
<span><span class="co">#&gt; 4 0.4091646 -0.3622108 0.6441129         1 0.4148814 -1.0054432 0.6533299</span></span>
<span><span class="co">#&gt; 5 0.4091646 -1.7556345 0.6441129         1 0.4148814 -0.6048528 0.6533299</span></span>
<span><span class="co">#&gt; 6 0.4091646  0.3447030 0.6441129         1 0.4148814 -0.5758447 0.6533299</span></span>
<span><span class="co">#&gt;   z_by_fs_z ev_fs_z  fs_x:fs_m fs_x:fs_m_se fs_x:fs_m_ld   fs_x:fs_z</span></span>
<span><span class="co">#&gt; 1         1 0.42684 -0.7264351    0.8973343            1  2.70788210</span></span>
<span><span class="co">#&gt; 2         1 0.42684 -1.5841821    0.8973343            1  1.03784270</span></span>
<span><span class="co">#&gt; 3         1 0.42684  1.0091489    0.8973343            1  0.65137310</span></span>
<span><span class="co">#&gt; 4         1 0.42684  0.3315466    0.8973343            1  1.02143110</span></span>
<span><span class="co">#&gt; 5         1 0.42684 -0.1608561    0.8973343            1 -0.15203845</span></span>
<span><span class="co">#&gt; 6         1 0.42684 -0.1879424    0.8973343            1  0.05347234</span></span>
<span><span class="co">#&gt;   fs_x:fs_z_se fs_x:fs_z_ld  fs_m:fs_z fs_m:fs_z_se fs_m:fs_z_ld</span></span>
<span><span class="co">#&gt; 1    0.8972113            1 -0.9848401    0.8723582            1</span></span>
<span><span class="co">#&gt; 2    0.8972113            1 -1.3451698    0.8723582            1</span></span>
<span><span class="co">#&gt; 3    0.8972113            1  0.8506663    0.8723582            1</span></span>
<span><span class="co">#&gt; 4    0.8972113            1  0.2757167    0.8723582            1</span></span>
<span><span class="co">#&gt; 5    0.8972113            1  0.9734347    0.8723582            1</span></span>
<span><span class="co">#&gt; 6    0.8972113            1 -0.2869611    0.8723582            1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="s-pa-with-product-factor-score-indicator-1">2S-PA with product factor score indicator<a class="anchor" aria-label="anchor" href="#s-pa-with-product-factor-score-indicator-1"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename product factor scores to be used with `tspa()`</span></span>
<span><span class="va">ind_3</span><span class="op">$</span><span class="va">fs_xm</span> <span class="op">&lt;-</span> <span class="va">ind_3</span><span class="op">$</span><span class="va">`fs_x:fs_m`</span></span>
<span><span class="va">ind_3</span><span class="op">$</span><span class="va">fs_xz</span> <span class="op">&lt;-</span> <span class="va">ind_3</span><span class="op">$</span><span class="va">`fs_x:fs_z`</span></span>
<span><span class="va">ind_3</span><span class="op">$</span><span class="va">fs_mz</span> <span class="op">&lt;-</span> <span class="va">ind_3</span><span class="op">$</span><span class="va">`fs_m:fs_z`</span></span>
<span><span class="va">tspa_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa.html">tspa</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  y ~ x + m + z + xm + xz + mz</span></span>
<span><span class="st">"</span>, data <span class="op">=</span> <span class="va">ind_3</span>,</span>
<span>  se_fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"se_fs_y"</span><span class="op">]</span>,</span>
<span>    x <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"se_fs_x"</span><span class="op">]</span>,</span>
<span>    m <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"se_fs_m"</span><span class="op">]</span>,</span>
<span>    z <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"se_fs_z"</span><span class="op">]</span>,</span>
<span>    xm <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_x:fs_m_se"</span><span class="op">]</span>,</span>
<span>    xz <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_x:fs_z_se"</span><span class="op">]</span>,</span>
<span>    mz <span class="op">=</span> <span class="va">ind_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"fs_m:fs_z_se"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedSolution</a></span><span class="op">(</span><span class="va">tspa_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs est.std    se       z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1      y =~  fs_y   0.742 0.006 122.531  0.000    0.730    0.754</span></span>
<span><span class="co">#&gt; 2      x =~  fs_x   0.818 0.004 202.761  0.000    0.810    0.826</span></span>
<span><span class="co">#&gt; 3      m =~  fs_m   0.795 0.005 171.575  0.000    0.786    0.804</span></span>
<span><span class="co">#&gt; 4      z =~  fs_z   0.783 0.005 158.160  0.000    0.773    0.792</span></span>
<span><span class="co">#&gt; 5     xm =~ fs_xm   0.661 0.009  77.654  0.000    0.644    0.678</span></span>
<span><span class="co">#&gt; 6     xz =~ fs_xz   0.647 0.009  72.179  0.000    0.630    0.665</span></span>
<span><span class="co">#&gt; 7     mz =~ fs_mz   0.649 0.009  72.823  0.000    0.632    0.667</span></span>
<span><span class="co">#&gt; 8   fs_y ~~  fs_y   0.449 0.009  50.000  0.000    0.432    0.467</span></span>
<span><span class="co">#&gt; 9   fs_x ~~  fs_x   0.330 0.007  50.000  0.000    0.317    0.343</span></span>
<span><span class="co">#&gt; 10  fs_m ~~  fs_m   0.368 0.007  50.000  0.000    0.354    0.383</span></span>
<span><span class="co">#&gt; 11  fs_z ~~  fs_z   0.387 0.008  50.000  0.000    0.372    0.403</span></span>
<span><span class="co">#&gt; 12 fs_xm ~~ fs_xm   0.563 0.011  50.000  0.000    0.541    0.585</span></span>
<span><span class="co">#&gt; 13 fs_xz ~~ fs_xz   0.581 0.012  50.000  0.000    0.558    0.604</span></span>
<span><span class="co">#&gt; 14 fs_mz ~~ fs_mz   0.579 0.012  50.000  0.000    0.556    0.601</span></span>
<span><span class="co">#&gt; 15     y  ~     x   0.341 0.022  15.440  0.000    0.297    0.384</span></span>
<span><span class="co">#&gt; 16     y  ~     m   0.406 0.022  18.551  0.000    0.363    0.448</span></span>
<span><span class="co">#&gt; 17     y  ~     z   0.189 0.024   8.040  0.000    0.143    0.235</span></span>
<span><span class="co">#&gt; 18     y  ~    xm   0.063 0.031   2.050  0.040    0.003    0.122</span></span>
<span><span class="co">#&gt; 19     y  ~    xz   0.179 0.029   6.098  0.000    0.121    0.236</span></span>
<span><span class="co">#&gt; 20     y  ~    mz   0.083 0.031   2.717  0.007    0.023    0.143</span></span>
<span><span class="co">#&gt; 21     y ~~     y   0.556 0.025  22.639  0.000    0.508    0.604</span></span>
<span><span class="co">#&gt; 22     x ~~     x   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 23     m ~~     m   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 24     z ~~     z   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 25    xm ~~    xm   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 26    xz ~~    xz   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 27    mz ~~    mz   1.000 0.000      NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 28     x ~~     m   0.106 0.022   4.900  0.000    0.063    0.148</span></span>
<span><span class="co">#&gt; 29     x ~~     z   0.167 0.022   7.665  0.000    0.124    0.209</span></span>
<span><span class="co">#&gt; 30     x ~~    xm  -0.029 0.026  -1.118  0.264   -0.080    0.022</span></span>
<span><span class="co">#&gt; 31     x ~~    xz  -0.065 0.027  -2.447  0.014   -0.117   -0.013</span></span>
<span><span class="co">#&gt; 32     x ~~    mz   0.027 0.027   1.022  0.307   -0.025    0.079</span></span>
<span><span class="co">#&gt; 33     m ~~     z   0.128 0.023   5.665  0.000    0.083    0.172</span></span>
<span><span class="co">#&gt; 34     m ~~    xm   0.032 0.027   1.203  0.229   -0.020    0.085</span></span>
<span><span class="co">#&gt; 35     m ~~    xz   0.029 0.027   1.044  0.296   -0.025    0.083</span></span>
<span><span class="co">#&gt; 36     m ~~    mz  -0.014 0.027  -0.503  0.615   -0.068    0.040</span></span>
<span><span class="co">#&gt; 37     z ~~    xm   0.028 0.027   1.039  0.299   -0.025    0.082</span></span>
<span><span class="co">#&gt; 38     z ~~    xz   0.047 0.028   1.687  0.092   -0.008    0.102</span></span>
<span><span class="co">#&gt; 39     z ~~    mz   0.028 0.028   1.003  0.316   -0.027    0.082</span></span>
<span><span class="co">#&gt; 40    xm ~~    xz   0.214 0.033   6.567  0.000    0.150    0.278</span></span>
<span><span class="co">#&gt; 41    xm ~~    mz   0.282 0.032   8.751  0.000    0.219    0.346</span></span>
<span><span class="co">#&gt; 42    xz ~~    mz   0.175 0.033   5.245  0.000    0.110    0.241</span></span></code></pre></div>
<p>Note that the unstandardized coefficients are on a different scale
compared to the previous example, as the latent variables are scaled
differently.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Hok Chio Lai, Yixiao Li, Winnie Wing-Yee Tse, Gengrui Zhang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
