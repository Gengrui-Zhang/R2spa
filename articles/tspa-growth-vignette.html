<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Linear Growth Modeling with Two-Stage Path Analysis • R2spa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear Growth Modeling with Two-Stage Path Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">R2spa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/R2spa.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical-interaction.html">Using Two-Stage Path Analysis with Definition Variables for Latent Interactions with Categorical Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/corrected-se.html">Corrected Standard Errors</a></li>
    <li><a class="dropdown-item" href="../articles/correction-error.html">Correction to Measurement Error</a></li>
    <li><a class="dropdown-item" href="../articles/efa-score.html">EFA Scores</a></li>
    <li><a class="dropdown-item" href="../articles/get_fs_int-vignette.html">get_fs_int-example</a></li>
    <li><a class="dropdown-item" href="../articles/gr-std-coef.html">Grand Standardized Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">2S-PA with Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-factors.html">Multi-Factor Measurement Model</a></li>
    <li><a class="dropdown-item" href="../articles/reliability.html">Reliability of Factor Scores</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-growth-vignette.html">Linear Growth Modeling with Two-Stage Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-plot-vignette.html">Diagnostic plots for `tspa` models</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-vignette-mx.html">Multi-Factor Measurement Model (OpenMx)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Linear Growth Modeling with Two-Stage Path Analysis</h1>
            
      

      <div class="d-none name"><code>tspa-growth-vignette.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gengrui-zhang.github.io/R2spa/">R2spa</a></span><span class="op">)</span></span></code></pre></div>
<p>We use the example from <a href="https://thechangelab.stanford.edu/tutorials/growth-modeling/measurement-invariance-2nd-order-growth-model/" class="external-link">this
tutorial</a> from Chapter 14 of the book <em>Growth Modeling</em>
(Grimm, Ram &amp; Estabrook, 2017) to demonstrate how to perform linear
growth modeling with two-stage path analysis (2S-PA)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="va">eclsk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/LRI-2/Data/main/GrowthModeling/ECLS_Science.dat"</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="st">"."</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">eclsk</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"s_g3"</span>, <span class="st">"r_g3"</span>, <span class="st">"m_g3"</span>, <span class="st">"s_g5"</span>, <span class="st">"r_g5"</span>, <span class="st">"m_g5"</span>, <span class="st">"s_g8"</span>,</span>
<span>                  <span class="st">"r_g8"</span>, <span class="st">"m_g8"</span>, <span class="st">"st_g3"</span>, <span class="st">"rt_g3"</span>, <span class="st">"mt_g3"</span>, <span class="st">"st_g5"</span>, <span class="st">"rt_g5"</span>,</span>
<span>                  <span class="st">"mt_g5"</span>, <span class="st">"st_g8"</span>, <span class="st">"rt_g8"</span>, <span class="st">"mt_g8"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="joint-structural-equation-model-latent-growth-with-strict-invariance-model">Joint structural equation model: Latent growth with strict
invariance model<a class="anchor" aria-label="anchor" href="#joint-structural-equation-model-latent-growth-with-strict-invariance-model"></a>
</h2>
<p>In the <a href="https://quantdev.ssri.psu.edu/tutorials/growth-modeling-chapter-14-modeling-change-latent-variables-measured-continuous" class="external-link">tutorial</a>,
the authors first performed longitudinal invariance testing and found
support for strict invariance. They moved on to fit a latent growth
model based on the strict invariance model, as shown below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jsem_growth_mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st"># factor loadings (with constraints)</span></span>
<span><span class="st">eta1 =~ 15.1749088 * s_g3 + l2 * r_g3 +  l3 * m_g3</span></span>
<span><span class="st">eta2 =~ 15.1749088 * s_g5 + l2 * r_g5 +  l3 * m_g5</span></span>
<span><span class="st">eta3 =~ 15.1749088 * s_g8 + l2 * r_g8 +  l3 * m_g8</span></span>
<span><span class="st"></span></span>
<span><span class="st"># factor variances</span></span>
<span><span class="st">eta1 ~~ psi * eta1</span></span>
<span><span class="st">eta2 ~~ psi * eta2</span></span>
<span><span class="st">eta3 ~~ psi * eta3</span></span>
<span><span class="st"></span></span>
<span><span class="st"># unique variances/covariances </span></span>
<span><span class="st">s_g3 ~~ u1 * s_g3 + s_g5 + s_g8</span></span>
<span><span class="st">s_g5 ~~ u1 * s_g5 + s_g8</span></span>
<span><span class="st">s_g8 ~~ u1 * s_g8</span></span>
<span><span class="st">r_g3 ~~ u2 * r_g3 + r_g5 + r_g8</span></span>
<span><span class="st">r_g5 ~~ u2 * r_g5 + r_g8</span></span>
<span><span class="st">r_g8 ~~ u2 * r_g8</span></span>
<span><span class="st">m_g3 ~~ u3 * m_g3 + m_g5 + m_g8</span></span>
<span><span class="st">m_g5 ~~ u3 * m_g5 + m_g8</span></span>
<span><span class="st">m_g8 ~~ u3 * m_g8</span></span>
<span><span class="st"></span></span>
<span><span class="st"># observed variable intercepts</span></span>
<span><span class="st">s_g3 ~ i1 * 1</span></span>
<span><span class="st">s_g5 ~ i1 * 1</span></span>
<span><span class="st">s_g8 ~ i1 * 1</span></span>
<span><span class="st">r_g3 ~ i2 * 1</span></span>
<span><span class="st">r_g5 ~ i2 * 1</span></span>
<span><span class="st">r_g8 ~ i2 * 1</span></span>
<span><span class="st">m_g3 ~ i3 * 1</span></span>
<span><span class="st">m_g5 ~ i3 * 1</span></span>
<span><span class="st">m_g8 ~ i3 * 1</span></span>
<span><span class="st"></span></span>
<span><span class="st"># latent basis model</span></span>
<span><span class="st">i =~ 1 * eta1 + 1 * eta2 + 1 * eta3</span></span>
<span><span class="st">s =~ 0 * eta1 + start(.5) * eta2 + 1 * eta3</span></span>
<span><span class="st"></span></span>
<span><span class="st">i ~~ start(.8) * i</span></span>
<span><span class="st">s ~~ start(.5) * s</span></span>
<span><span class="st">i ~~ start(0) * s</span></span>
<span><span class="st"></span></span>
<span><span class="st">i ~ 0 * 1</span></span>
<span><span class="st">s ~ 1</span></span>
<span><span class="st">"</span></span>
<span><span class="va">jsem_growth_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan</a></span><span class="op">(</span><span class="va">jsem_growth_mod</span>,</span>
<span>                          data <span class="op">=</span> <span class="va">eclsk</span>,</span>
<span>                          meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          estimator <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                          fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="s-pa-latent-growth-with-strict-invariance-model">2S-PA: Latent growth with strict invariance model<a class="anchor" aria-label="anchor" href="#s-pa-latent-growth-with-strict-invariance-model"></a>
</h2>
<p>With 2S-PA, we first specify the strict invariance model, directly
adopted from the <a href="https://quantdev.ssri.psu.edu/tutorials/growth-modeling-chapter-14-modeling-change-latent-variables-measured-continuous" class="external-link">tutorial</a>.
Based on the strict invariance model, we then obtain the factor
scores.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strict_mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st"># factor loadings</span></span>
<span><span class="st">eta1 =~ 15.1749088 * s_g3 + l2 * r_g3 + l3 * m_g3</span></span>
<span><span class="st">eta2 =~ 15.1749088 * s_g5 + l2 * r_g5 + l3 * m_g5</span></span>
<span><span class="st">eta3 =~ 15.1749088 * s_g8 + l2 * r_g8 + l3 * m_g8</span></span>
<span><span class="st"></span></span>
<span><span class="st"># factor variances/covariances</span></span>
<span><span class="st">eta1 ~~ 1 * eta1 + eta2 + eta3</span></span>
<span><span class="st">eta2 ~~ eta2 + eta3</span></span>
<span><span class="st">eta3 ~~ eta3</span></span>
<span><span class="st"></span></span>
<span><span class="st"># unique variances/covariances</span></span>
<span><span class="st">s_g3 ~~ u1 * s_g3 + s_g5 + s_g8</span></span>
<span><span class="st">s_g5 ~~ u1 * s_g5 + s_g8</span></span>
<span><span class="st">s_g8 ~~ u1 * s_g8</span></span>
<span><span class="st">r_g3 ~~ u2 * r_g3 + r_g5 + r_g8</span></span>
<span><span class="st">r_g5 ~~ u2 * r_g5 + r_g8</span></span>
<span><span class="st">r_g8 ~~ u2 * r_g8</span></span>
<span><span class="st">m_g3 ~~ u3 * m_g3 + m_g5 + m_g8</span></span>
<span><span class="st">m_g5 ~~ u3 * m_g5 + m_g8</span></span>
<span><span class="st">m_g8 ~~ u3 * m_g8</span></span>
<span><span class="st"></span></span>
<span><span class="st"># latent variable intercepts</span></span>
<span><span class="st">eta1 ~ 0 * 1</span></span>
<span><span class="st">eta2 ~ 1</span></span>
<span><span class="st">eta3 ~ 1</span></span>
<span><span class="st"></span></span>
<span><span class="st"># observed variable intercepts</span></span>
<span><span class="st">s_g3 ~ i1 * 1</span></span>
<span><span class="st">s_g5 ~ i1 * 1</span></span>
<span><span class="st">s_g8 ~ i1 * 1</span></span>
<span><span class="st">r_g3 ~ i2 * 1</span></span>
<span><span class="st">r_g5 ~ i2 * 1</span></span>
<span><span class="st">r_g8 ~ i2 * 1</span></span>
<span><span class="st">m_g3 ~ i3 * 1</span></span>
<span><span class="st">m_g5 ~ i3 * 1</span></span>
<span><span class="st">m_g8 ~ i3 * 1</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get factor scores</span></span>
<span><span class="va">fs_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fs.html">get_fs</a></span><span class="op">(</span><span class="va">eclsk</span>, model <span class="op">=</span> <span class="va">strict_mod</span><span class="op">)</span></span></code></pre></div>
<p>In the second stage, we use the factor scores obtained from the
strict invariance model to model the growth trajectory across time
points. The growth model is the same as the “latent basis model” in the
joint structural equation model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Growth model</span></span>
<span><span class="va">tspa_growth_mod</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">i =~ 1 * eta1 + 1 * eta2 + 1 * eta3</span></span>
<span><span class="st">s =~ 0 * eta1 + start(.5) * eta2 + 1 * eta3</span></span>
<span><span class="st"></span></span>
<span><span class="st"># factor variances</span></span>
<span><span class="st">eta1 ~~ psi * eta1</span></span>
<span><span class="st">eta2 ~~ psi * eta2</span></span>
<span><span class="st">eta3 ~~ psi * eta3</span></span>
<span><span class="st"></span></span>
<span><span class="st">i ~~ start(.8) * i</span></span>
<span><span class="st">s ~~ start(.5) * s</span></span>
<span><span class="st">i ~~ start(0) * s</span></span>
<span><span class="st"></span></span>
<span><span class="st">i ~ 1</span></span>
<span><span class="st">s ~ 1</span></span>
<span><span class="st">"</span></span>
<span><span class="co"># Fit the growth model</span></span>
<span><span class="va">tspa_growth_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa.html">tspa</a></span><span class="op">(</span><span class="va">tspa_growth_mod</span>, <span class="va">fs_dat</span>,</span>
<span>                        fsT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat</span>, <span class="st">"fsT"</span><span class="op">)</span>,</span>
<span>                        fsL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat</span>, <span class="st">"fsL"</span><span class="op">)</span>,</span>
<span>                        fsb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs_dat</span>, <span class="st">"fsb"</span><span class="op">)</span>,</span>
<span>                        estimator <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h2>
<p>The joint structural equation model and 2S-PA yielded comparable
estimates of the mean and variances of the intercept and slope
factors.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterestimates</a></span><span class="op">(</span><span class="va">tspa_growth_fit</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="va">lhs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"s"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">op</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~1"</span>, <span class="st">"~~"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    lhs op rhs label    est    se       z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 28   i ~~   i        0.944 0.051  18.592  0.000    0.845    1.044</span></span>
<span><span class="co">#&gt; 29   s ~~   s        0.118 0.016   7.298  0.000    0.086    0.149</span></span>
<span><span class="co">#&gt; 30   i ~~   s       -0.076 0.020  -3.757  0.000   -0.116   -0.036</span></span>
<span><span class="co">#&gt; 31   i ~1            0.001 0.035   0.016  0.987   -0.068    0.069</span></span>
<span><span class="co">#&gt; 32   s ~1            1.993 0.019 107.413  0.000    1.957    2.030</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">parameterestimates</a></span><span class="op">(</span><span class="va">jsem_growth_fit</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="va">lhs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"s"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">op</span>  <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~1"</span>, <span class="st">"~~"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    lhs op rhs label    est    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 46   i ~~   i        0.941 0.052 18.138      0    0.839    1.042</span></span>
<span><span class="co">#&gt; 47   s ~~   s        0.117 0.017  6.826      0    0.083    0.150</span></span>
<span><span class="co">#&gt; 48   i ~~   s       -0.074 0.020 -3.646      0   -0.115   -0.034</span></span>
<span><span class="co">#&gt; 49   i ~1            0.000 0.000     NA     NA    0.000    0.000</span></span>
<span><span class="co">#&gt; 50   s ~1            1.991 0.024 84.586      0    1.945    2.038</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Hok Chio Lai, Yixiao Li, Winnie Wing-Yee Tse, Gengrui Zhang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
