<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2S-PA with Missing Data â€¢ R2spa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2S-PA with Missing Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">R2spa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/R2spa.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical-interaction.html">Using Two-Stage Path Analysis with Definition Variables for Latent Interactions with Categorical Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/corrected-se.html">Corrected Standard Errors</a></li>
    <li><a class="dropdown-item" href="../articles/correction-error.html">Correction to Measurement Error</a></li>
    <li><a class="dropdown-item" href="../articles/efa-score.html">EFA Scores</a></li>
    <li><a class="dropdown-item" href="../articles/get_fs_int-vignette.html">get_fs_int-example</a></li>
    <li><a class="dropdown-item" href="../articles/gr-std-coef.html">Grand Standardized Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/missing-data.html">2S-PA with Missing Data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-factors.html">Multi-Factor Measurement Model</a></li>
    <li><a class="dropdown-item" href="../articles/reliability.html">Reliability of Factor Scores</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-growth-vignette.html">Linear Growth Modeling with Two-Stage Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-plot-vignette.html">Diagnostic plots for `tspa` models</a></li>
    <li><a class="dropdown-item" href="../articles/tspa-vignette-mx.html">Multi-Factor Measurement Model (OpenMx)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>2S-PA with Missing Data</h1>
                        <h4 data-toc-skip class="author">Mark Lai</h4>
            
            <h4 data-toc-skip class="date">2024-09-06</h4>
      

      <div class="d-none name"><code>missing-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="single-factor-model">Single-Factor Model<a class="anchor" aria-label="anchor" href="#single-factor-model"></a>
</h2>
<p>For illustration, we will create an artificial data set with two
missing data pattern:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2225</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-18</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gengrui-zhang.github.io/R2spa/">R2spa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tbates/umx#readme" class="external-link">umx</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: OpenMx</span></span>
<span><span class="co">#&gt; To take full advantage of multiple cores, use:</span></span>
<span><span class="co">#&gt;   mxOption(key='Number of Threads', value=parallel::detectCores()) #now</span></span>
<span><span class="co">#&gt;   Sys.setenv(OMP_NUM_THREADS=parallel::detectCores()) #before library(OpenMx)</span></span>
<span><span class="co">#&gt; For an overview type '?umx'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'umx'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span><span class="op">)</span></span>
<span><span class="va">pd2</span> <span class="op">&lt;-</span> <span class="va">PoliticalDemocracy</span></span>
<span><span class="co"># Add MCAR missing data</span></span>
<span><span class="va">pd2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">75</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>, <span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Factor scores with <code><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavaan::lavPredict()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"ind60 =~ x1 + x2 + x3"</span>, data <span class="op">=</span> <span class="va">pd2</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="va">fs_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, fsm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># # extract scoring matrix</span></span>
<span><span class="co"># fsm &lt;- attr(fs_lavaan, "fsm")[[1]]</span></span>
<span><span class="co"># # se for observations with complete data</span></span>
<span><span class="co"># th &lt;- lavInspect(fit, what = "est")$theta</span></span>
<span><span class="co"># sqrt(diag(fsm %*% th %*% t(fsm)))</span></span>
<span><span class="co"># # se for observations missing item 1 (need conditional normal)</span></span>
<span><span class="co"># fsm_mis1 &lt;- with(lavInspect(fit, what = "est"), {</span></span>
<span><span class="co">#     lambda &lt;- lambda[2:3, , drop = FALSE]</span></span>
<span><span class="co">#     theta &lt;- theta[2:3, 2:3, drop = FALSE]</span></span>
<span><span class="co">#     # covy &lt;- (lambda %*% psi %*% t(lambda) + theta)</span></span>
<span><span class="co">#     # ginvcovy &lt;- MASS::ginv(covy)</span></span>
<span><span class="co">#     # tlam_invcov &lt;- crossprod(lambda, ginvcovy)</span></span>
<span><span class="co">#     # psi %*% tlam_invcov</span></span>
<span><span class="co">#     lamt_th_lam &lt;- crossprod(lambda, solve(theta, lambda))</span></span>
<span><span class="co">#     solve(lamt_th_lam, crossprod(lambda, solve(theta)))</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># sqrt(diag(fsm_mis1 %*% th[2:3, 2:3, drop = FALSE] %*% t(fsm_mis1)))</span></span>
<span><span class="co"># From R2spa</span></span>
<span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu">R2spa</span><span class="fu">::</span><span class="fu"><a href="../reference/get_fs_lavaan.html">get_fs_lavaan</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span><span class="op">)</span></span>
<span><span class="co"># Compare factor scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fs_lavaan</span>, <span class="va">fs</span><span class="op">$</span><span class="va">fs_ind60</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="missing-data_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="section level3">
<h3 id="multiple-group">Multiple group<a class="anchor" aria-label="anchor" href="#multiple-group"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"ind60 =~ x1 + x2 + x3"</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pd2</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  missing <span class="op">=</span> <span class="st">"fiml"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">R2spa</span><span class="fu">::</span><span class="fu"><a href="../reference/get_fs_lavaan.html">get_fs_lavaan</a></span><span class="op">(</span><span class="va">mg_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;        fs_ind60 fs_ind60_se ind60_by_fs_ind60 ev_fs_ind60 group</span></span>
<span><span class="co">#&gt; 1  -0.629897437  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 2  -0.003597801  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 3   0.531621454  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 4   1.093150997  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 5   0.751322856  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 6   0.032310335  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 7  -0.001194933  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 8  -0.081265180  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 9   0.087671139  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 10  0.158890547  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 11  0.575151483  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 12  0.490722985  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 13  1.199738770  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 14  0.080689638  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 15  0.479293472  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 16  0.304725162  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 17 -0.006880589  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 18 -0.232201592  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 19  0.734594167  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 20  0.871472984  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 21  0.749217422  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 22  0.726471949  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 23  0.397941787  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 24  0.446676514  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 25  0.726400152  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 26 -1.023191030  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 27 -0.229774171  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 28 -0.589883012  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 29 -0.944983987  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 30 -1.473429633  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 31 -0.386068258  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 32 -1.339301841  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 33 -0.282299077  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 34 -0.197502508  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 35 -0.419983839  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 36 -0.737560746  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 37  0.066032960  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 38 -0.644149975  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; 39 -1.198883624  0.06481192         0.9902871 0.004200585     1</span></span>
<span><span class="co">#&gt; 40 -0.082046566  0.06327033         0.9907480 0.004003135     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt;       fs_ind60 fs_ind60_se ind60_by_fs_ind60 ev_fs_ind60 group</span></span>
<span><span class="co">#&gt; 1   0.11486330    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 2  -0.41073122    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 3  -0.15711924    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 4  -0.76084565    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 5  -0.88026683    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 6  -0.74845673    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 7  -0.85061057    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 8  -0.55025232    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 9   0.26138642    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 10  0.32087466    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 11  0.50410306    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 12 -0.30439462    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 13  0.57282757    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 14  0.21646719    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 15  0.56163448    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 16  0.30298279    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 17  0.50001516    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 18  0.74949815    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 19  0.62556020    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 20  1.22362501    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 21  0.28280329    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 22 -0.72202779    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 23 -0.53354639    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 24  0.02656067    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 25 -0.10062174    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 26  0.19661034    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 27  0.17401287    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 28 -0.85294266    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 29 -0.30843400    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 30 -0.49547393    0.172422         0.8992304  0.02972934     2</span></span>
<span><span class="co">#&gt; 31 -0.46151949    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 32  0.39305019    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 33  1.01756027    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 34  0.23274175    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; 35 -0.13995593    0.132523         0.9432493  0.01756235     2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsT")</span></span>
<span><span class="co">#&gt; attr(,"fsT")$`1`</span></span>
<span><span class="co">#&gt;             fs_ind60</span></span>
<span><span class="co">#&gt; fs_ind60 0.004003135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsT")$`2`</span></span>
<span><span class="co">#&gt;            fs_ind60</span></span>
<span><span class="co">#&gt; fs_ind60 0.01756235</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsL")</span></span>
<span><span class="co">#&gt; attr(,"fsL")$`1`</span></span>
<span><span class="co">#&gt;             ind60</span></span>
<span><span class="co">#&gt; fs_ind60 0.990748</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsL")$`2`</span></span>
<span><span class="co">#&gt;              ind60</span></span>
<span><span class="co">#&gt; fs_ind60 0.9432493</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsb")</span></span>
<span><span class="co">#&gt; attr(,"fsb")$`1`</span></span>
<span><span class="co">#&gt; fs_ind60 </span></span>
<span><span class="co">#&gt;        0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"fsb")$`2`</span></span>
<span><span class="co">#&gt; fs_ind60 </span></span>
<span><span class="co">#&gt;        0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"scoring_matrix")</span></span>
<span><span class="co">#&gt; attr(,"scoring_matrix")$`1`</span></span>
<span><span class="co">#&gt;             [,1]      [,2]       [,3]</span></span>
<span><span class="co">#&gt; ind60 0.04744877 0.4008488 0.01499426</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"scoring_matrix")$`2`</span></span>
<span><span class="co">#&gt;            [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; ind60 0.4368268 0.1137155 0.1263754</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multiple-factor-model">Multiple-Factor Model<a class="anchor" aria-label="anchor" href="#multiple-factor-model"></a>
</h2>
<div class="section level3">
<h3 id="regression-scores">Regression scores<a class="anchor" aria-label="anchor" href="#regression-scores"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make last 10 cases completely missing on y5-y8</span></span>
<span><span class="va">pd2</span><span class="op">[</span><span class="fl">66</span><span class="op">:</span><span class="fl">75</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  dem60 =~ a * y1 + b * y2 + c * y3 + d * y4</span></span>
<span><span class="st">  dem65 =~ a * y5 + b * y6 + c * y7 + d * y8</span></span>
<span><span class="st">  y1 ~~ y5</span></span>
<span><span class="st">  y2 ~~ y6</span></span>
<span><span class="st">  y3 ~~ y7</span></span>
<span><span class="st">  y4 ~~ y8</span></span>
<span><span class="st">"</span>, data <span class="op">=</span> <span class="va">pd2</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="va">fs2r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">fit2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EBM"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  acov <span class="op">=</span> <span class="cn">TRUE</span>, fsm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">acov_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fs2r</span>, <span class="st">"acov"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># Obtain tidy-ed factor scores data</span></span>
<span><span class="va">fs_dat</span> <span class="op">&lt;-</span> <span class="fu">R2spa</span><span class="fu">::</span><span class="fu"><a href="../reference/augment_lav_predict.html">augment_lav_predict</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span><span class="co"># Run 2spa with OpenMx</span></span>
<span><span class="co"># Build OpenMx model</span></span>
<span><span class="va">fsreg_umx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/umx/man/umxLav2RAM.html" class="external-link">umxLav2RAM</a></span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">    dem65 ~ dem60</span></span>
<span><span class="st">    dem65 + dem60 ~ 1</span></span>
<span><span class="st">  "</span>,</span>
<span>  printTab <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ?plot.MxModel options: std, means, digits, strip_zero, file, splines=T/F/ortho,..., min=, max =, same = , fixed, resid= 'circle|line|none'</span></span>
<span><span class="va">cross_load</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dem60_by_fs_dem60"</span>, <span class="st">"dem60_by_fs_dem65"</span>,</span>
<span>  <span class="st">"dem65_by_fs_dem60"</span>, <span class="st">"dem65_by_fs_dem65"</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">`dimnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_dem60"</span>, <span class="st">"fs_dem65"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dem60"</span>, <span class="st">"dem65"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">err_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"ev_fs_dem60"</span>, <span class="st">"ecov_fs_dem60_fs_dem65"</span>,</span>
<span>  <span class="st">"ecov_fs_dem60_fs_dem65"</span>, <span class="st">"ev_fs_dem65"</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">`dimnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fs_dem60"</span>, <span class="st">"fs_dem65"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Need to make factor scores NA when loadings/error variances</span></span>
<span><span class="co"># are inadmissible</span></span>
<span><span class="va">fs_dat</span><span class="op">[</span><span class="fl">66</span><span class="op">:</span><span class="fl">75</span>, <span class="st">"fs_dem65"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">tspa_mx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa_mx_model.html">tspa_mx_model</a></span><span class="op">(</span><span class="va">fsreg_umx</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fs_dat</span>,</span>
<span>  mat_ld <span class="op">=</span> <span class="va">cross_load</span>, mat_ev <span class="op">=</span> <span class="va">err_cov</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Run OpenMx</span></span>
<span><span class="va">tspa_mx_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxRun.html" class="external-link">mxRun</a></span><span class="op">(</span><span class="va">tspa_mx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running 2SPAD with 5 parameters</span></span>
<span><span class="co"># Summarize the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tspa_mx_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of 2SPAD </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; free parameters:</span></span>
<span><span class="co">#&gt;               name matrix   row   col      Estimate  Std.Error A</span></span>
<span><span class="co">#&gt; 1   dem60_to_dem65   m1.A dem65 dem60  9.125862e-01 0.07157358  </span></span>
<span><span class="co">#&gt; 2 dem65_with_dem65   m1.S dem65 dem65  5.369808e-01 0.23101709  </span></span>
<span><span class="co">#&gt; 3 dem60_with_dem60   m1.S dem60 dem60  4.559667e+00 0.84137910  </span></span>
<span><span class="co">#&gt; 4     one_to_dem65   m1.M     1 dem65  1.424734e-08 0.14212140  </span></span>
<span><span class="co">#&gt; 5     one_to_dem60   m1.M     1 dem60 -2.019359e-08 0.26210295  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Statistics: </span></span>
<span><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)</span></span>
<span><span class="co">#&gt;        Model:              5                    275              404.9387</span></span>
<span><span class="co">#&gt;    Saturated:             NA                     NA                    NA</span></span>
<span><span class="co">#&gt; Independence:             NA                     NA                    NA</span></span>
<span><span class="co">#&gt; Number of observations/statistics: 75/280</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Information Criteria: </span></span>
<span><span class="co">#&gt;       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted</span></span>
<span><span class="co">#&gt; AIC:      -145.0613               414.9387                 415.8083</span></span>
<span><span class="co">#&gt; BIC:      -782.3705               426.5261                 410.7675</span></span>
<span><span class="co">#&gt; CFI: NA </span></span>
<span><span class="co">#&gt; TLI: 1   (also known as NNFI) </span></span>
<span><span class="co">#&gt; RMSEA:  0  [95% CI (NA, NA)]</span></span>
<span><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): NA</span></span>
<span><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></span>
<span><span class="co">#&gt; timestamp: 2024-09-06 04:19:22 </span></span>
<span><span class="co">#&gt; Wall clock time: 0.05901241 secs </span></span>
<span><span class="co">#&gt; optimizer:  SLSQP </span></span>
<span><span class="co">#&gt; OpenMx version number: 2.21.12 </span></span>
<span><span class="co">#&gt; Need help?  See help(mxSummary)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bartlett-scores">Bartlett scores<a class="anchor" aria-label="anchor" href="#bartlett-scores"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain tidy-ed factor scores data</span></span>
<span><span class="va">fsb_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment_lav_predict.html">augment_lav_predict</a></span><span class="op">(</span><span class="va">fit2</span>, method <span class="op">=</span> <span class="st">"Bartlett"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in sqrt(diag(fsT)): NaNs produced</span></span>
<span><span class="va">tspab_mx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tspa_mx_model.html">tspa_mx_model</a></span><span class="op">(</span><span class="va">fsreg_umx</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fsb_dat</span>,</span>
<span>  mat_ld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsb_dat</span>, which <span class="op">=</span> <span class="st">"ld"</span><span class="op">)</span>,</span>
<span>  mat_ev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fsb_dat</span>, which <span class="op">=</span> <span class="st">"ev"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Run OpenMx</span></span>
<span><span class="va">tspab_mx_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxRun.html" class="external-link">mxRun</a></span><span class="op">(</span><span class="va">tspab_mx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running 2SPAD with 5 parameters</span></span>
<span><span class="co"># Summarize the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tspab_mx_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of 2SPAD </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; free parameters:</span></span>
<span><span class="co">#&gt;               name matrix   row   col      Estimate  Std.Error A</span></span>
<span><span class="co">#&gt; 1   dem60_to_dem65   m1.A dem65 dem60  9.125862e-01 0.07157513  </span></span>
<span><span class="co">#&gt; 2 dem65_with_dem65   m1.S dem65 dem65  5.369808e-01 0.23103302  </span></span>
<span><span class="co">#&gt; 3 dem60_with_dem60   m1.S dem60 dem60  4.559667e+00 0.84138189  </span></span>
<span><span class="co">#&gt; 4     one_to_dem65   m1.M     1 dem65  1.424717e-08 0.14211902  </span></span>
<span><span class="co">#&gt; 5     one_to_dem60   m1.M     1 dem60 -2.004115e-08 0.26209661  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Statistics: </span></span>
<span><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)</span></span>
<span><span class="co">#&gt;        Model:              5                    275              536.4213</span></span>
<span><span class="co">#&gt;    Saturated:             NA                     NA                    NA</span></span>
<span><span class="co">#&gt; Independence:             NA                     NA                    NA</span></span>
<span><span class="co">#&gt; Number of observations/statistics: 75/280</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Information Criteria: </span></span>
<span><span class="co">#&gt;       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted</span></span>
<span><span class="co">#&gt; AIC:      -13.57873               546.4213                 547.2908</span></span>
<span><span class="co">#&gt; BIC:     -650.88796               558.0087                 542.2500</span></span>
<span><span class="co">#&gt; CFI: NA </span></span>
<span><span class="co">#&gt; TLI: 1   (also known as NNFI) </span></span>
<span><span class="co">#&gt; RMSEA:  0  [95% CI (NA, NA)]</span></span>
<span><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): NA</span></span>
<span><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></span>
<span><span class="co">#&gt; timestamp: 2024-09-06 04:19:22 </span></span>
<span><span class="co">#&gt; Wall clock time: 0.07445168 secs </span></span>
<span><span class="co">#&gt; optimizer:  SLSQP </span></span>
<span><span class="co">#&gt; OpenMx version number: 2.21.12 </span></span>
<span><span class="co">#&gt; Need help?  See help(mxSummary)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compared-to-joint-model">Compared to Joint Model<a class="anchor" aria-label="anchor" href="#compared-to-joint-model"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  dem60 =~ a * y1 + b * y2 + c * y3 + d * y4</span></span>
<span><span class="st">  dem65 =~ a * y5 + b * y6 + c * y7 + d * y8</span></span>
<span><span class="st">  y1 ~~ y5</span></span>
<span><span class="st">  y2 ~~ y6</span></span>
<span><span class="st">  y3 ~~ y7</span></span>
<span><span class="st">  y4 ~~ y8</span></span>
<span><span class="st">  dem65 ~ dem60</span></span>
<span><span class="st">"</span>, data <span class="op">=</span> <span class="va">pd2</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-18 ended normally after 53 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        29</span></span>
<span><span class="co">#&gt;   Number of equality constraints                     3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            75</span></span>
<span><span class="co">#&gt;   Number of missing patterns                         2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                27.499</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                18</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.070</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Observed</span></span>
<span><span class="co">#&gt;   Observed information based on                Hessian</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   dem60 =~                                            </span></span>
<span><span class="co">#&gt;     y1         (a)    1.000                           </span></span>
<span><span class="co">#&gt;     y2         (b)    1.337    0.153    8.738    0.000</span></span>
<span><span class="co">#&gt;     y3         (c)    1.182    0.132    8.942    0.000</span></span>
<span><span class="co">#&gt;     y4         (d)    1.334    0.136    9.777    0.000</span></span>
<span><span class="co">#&gt;   dem65 =~                                            </span></span>
<span><span class="co">#&gt;     y5         (a)    1.000                           </span></span>
<span><span class="co">#&gt;     y6         (b)    1.337    0.153    8.738    0.000</span></span>
<span><span class="co">#&gt;     y7         (c)    1.182    0.132    8.942    0.000</span></span>
<span><span class="co">#&gt;     y8         (d)    1.334    0.136    9.777    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   dem65 ~                                             </span></span>
<span><span class="co">#&gt;     dem60             0.913    0.074   12.357    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;  .y1 ~~                                               </span></span>
<span><span class="co">#&gt;    .y5                0.627    0.395    1.587    0.113</span></span>
<span><span class="co">#&gt;  .y2 ~~                                               </span></span>
<span><span class="co">#&gt;    .y6                1.238    0.765    1.618    0.106</span></span>
<span><span class="co">#&gt;  .y3 ~~                                               </span></span>
<span><span class="co">#&gt;    .y7                1.534    0.695    2.207    0.027</span></span>
<span><span class="co">#&gt;  .y4 ~~                                               </span></span>
<span><span class="co">#&gt;    .y8                0.200    0.551    0.363    0.716</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .y1                5.465    0.298   18.348    0.000</span></span>
<span><span class="co">#&gt;    .y2                4.256    0.442    9.629    0.000</span></span>
<span><span class="co">#&gt;    .y3                6.563    0.397   16.534    0.000</span></span>
<span><span class="co">#&gt;    .y4                4.453    0.379   11.733    0.000</span></span>
<span><span class="co">#&gt;    .y5                5.181    0.313   16.561    0.000</span></span>
<span><span class="co">#&gt;    .y6                2.782    0.403    6.899    0.000</span></span>
<span><span class="co">#&gt;    .y7                6.249    0.367   17.043    0.000</span></span>
<span><span class="co">#&gt;    .y8                3.996    0.383   10.420    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .y1                2.093    0.490    4.276    0.000</span></span>
<span><span class="co">#&gt;    .y2                6.502    1.252    5.195    0.000</span></span>
<span><span class="co">#&gt;    .y3                5.443    1.038    5.242    0.000</span></span>
<span><span class="co">#&gt;    .y4                2.689    0.716    3.756    0.000</span></span>
<span><span class="co">#&gt;    .y5                2.528    0.551    4.588    0.000</span></span>
<span><span class="co">#&gt;    .y6                3.677    0.827    4.446    0.000</span></span>
<span><span class="co">#&gt;    .y7                3.386    0.760    4.453    0.000</span></span>
<span><span class="co">#&gt;    .y8                2.628    0.702    3.745    0.000</span></span>
<span><span class="co">#&gt;     dem60             4.560    1.038    4.394    0.000</span></span>
<span><span class="co">#&gt;    .dem65             0.537    0.258    2.085    0.037</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-group-1">Multiple group<a class="anchor" aria-label="anchor" href="#multiple-group-1"></a>
</h3>
<p>Just to demonstrate the syntax for obtaining the input data</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mg_fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  dem60 =~ a * y1 + b * y2 + c * y3 + d * y4</span></span>
<span><span class="st">  dem65 =~ a * y5 + b * y6 + c * y7 + d * y8</span></span>
<span><span class="st">  y1 ~~ y5</span></span>
<span><span class="st">  y2 ~~ y6</span></span>
<span><span class="st">  y3 ~~ y7</span></span>
<span><span class="st">  y4 ~~ y8</span></span>
<span><span class="st">"</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pd2</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  missing <span class="op">=</span> <span class="st">"fiml"</span>, group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: lavaan-&gt;lavParTable():  </span></span>
<span><span class="co">#&gt;    using a single label per parameter in a multiple group setting implies </span></span>
<span><span class="co">#&gt;    imposing equality constraints across all the groups; If this is not </span></span>
<span><span class="co">#&gt;    intended, either remove the label(s), or use a vector of labels (one for </span></span>
<span><span class="co">#&gt;    each group); See the Multiple groups section in the man page of </span></span>
<span><span class="co">#&gt;    model.syntax.</span></span>
<span><span class="fu"><a href="../reference/augment_lav_predict.html">augment_lav_predict</a></span><span class="op">(</span><span class="va">mg_fit2</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Hok Chio Lai, Yixiao Li, Winnie Wing-Yee Tse, Gengrui Zhang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
